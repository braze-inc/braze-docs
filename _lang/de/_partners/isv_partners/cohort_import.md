---
nav_title: Integration von Kohortenimporten
alias: /cohort_import/
hidden: true
---

# Integration von Partnerkohortenimporten

> Die Funktion Partnerkohorten-Import ermöglicht unseren Partnern die Integration mit Braze, um Kohorten von Benutzern zu senden, die in der Anwendung des Partners erstellt wurden.

## Cluster-URLs

Braze hostet unsere Anwendung auf mehreren Clustern in den USA und der EU. Die URL für die Import-Endpunkte ist je nach Cluster, in dem die Instanz des Kundenunternehmens gehostet wird, unterschiedlich:

| INSTANZ | REST ENDPOINT |
| ----- | ------------------------------- |
| US-01 | `https://rest.iad-01.braze.com` |
| US-02 | `https://rest.iad-02.braze.com` |
| US-03 | `https://rest.iad-03.braze.com` |
| US-04 | `https://rest.iad-04.braze.com` |
| US-05 | `https://rest.iad-05.braze.com` |
| US-06 | `https://rest.iad-06.braze.com` |
| US-07 | `https://rest.iad-07.braze.com` |
| US-08 | `https://rest.iad-08.braze.com` |
| EU-01 | `https://rest.fra-01.braze.eu`  |
| EU-02 | `https://rest.fra-02.braze.eu`  |
{: .reset-td-br-1 .reset-td-br-2 role="presentation" }

## Endpunkt-URLs

Die Top-Level-URLs sind nicht nur cluster-spezifisch, sondern jeder Endpunkt ist auch partnerspezifisch. Beim Import in unseren US01-Cluster hätte die URL beispielsweise das Format `https://rest.iad-01.braze.com/partners/[partner_name]/…`, wobei `[partner_name]` in der Regel der Name des Unternehmens des Partners ist. Die Besonderheiten der einzelnen Endpunkte werden in den folgenden Abschnitten beschrieben.

## Authentifizierung

Um Kohortendaten in Braze zu importieren, sind zwei Authentifizierungsschlüssel erforderlich.

### Partner-API-Schlüssel

Der Partner-API-Schlüssel identifiziert den Integrationspartner und bestätigt, dass die Anfrage für den Import gültig ist. Der Schlüssel sollte im Text der Anfrage im Feld `partner_api_key` enthalten sein.

Beim Einrichten der Integration in der Anwendung des Partners sollte der Kunde aufgefordert werden, seinen Braze-Cluster anzugeben, damit die Integration weiß, welche Cluster-URL und welchen Partner-API-Schlüssel sie beim Importieren von Daten verwenden soll.

Braze stellt dem Partner den/die Partner-API-Schlüssel zur Verfügung, bevor der Partner mit der Integrationsentwicklung beginnt. Im Allgemeinen werden wir einen einzigen Schlüssel bereitstellen, der für alle US-Cluster gültig ist, und einen weiteren Schlüssel, der für unseren EU-Cluster gültig ist.

### Schlüssel für den Import von Kundendaten

Der Client-Datenimportschlüssel identifiziert den Client-Arbeitsbereich, in den die Kohorte importiert werden soll. Der Schlüssel sollte im Text der Anfrage im Feld `client_secret` enthalten sein.

Dieser Schlüssel wird im Dashboard des Kunden in den Integrationseinstellungen für den Partner erstellt. Beim Einrichten der Integration in der Anwendung des Partners sollte der Kunde aufgefordert werden, seinen Datenimportschlüssel anzugeben, damit die Integration weiß, an welchen Client und Arbeitsbereich sie Daten senden soll.

## API-Endpunkt-Spezifikationen

### Kohortenname Endpunkt

Der Endpunkt Kohortenname kann verwendet werden, um den Namen einer Kohorte auf der Grundlage ihrer ID anzugeben. Dieser Endpunkt sollte immer dann aufgerufen werden, wenn eine Kohorte zum ersten Mal nach Braze exportiert wird oder wenn der Name einer bereits in Braze bekannten Kohorte geändert wird.

| Feld | Typ | Erforderlich | Anmerkungen |
| ----- | ---- | -------- | ----- |
| `partner_api_key` | String | Ja | Partnerspezifischer API-Schlüssel, der bei allen Anfragen von Partnern an Braze verwendet wird. Dieser Schlüssel ist clusterspezifisch (siehe [Partner-API-Schlüssel](#partner-api-key)), so dass der Partner den Cluster kennen muss, in den die Kohorten geschrieben werden sollen. |
| `client_secret` | String | Ja | Datenimportschlüssel für den Kunden, zu dessen Kohorte dies gehört. |
| `cohort_id` | String | Ja | Identifikator für die Kohorte. Diese Kennung sollte für den angegebenen Client eindeutig sein. |
| `name` | String | Ja | Vom Kunden festgelegter Name für die Kohorte |
| `created_at` | String | Ja | Zeitstempel im ISO-8601-Format |
{: .reset-td-br-1 .reset-td-br-2 .reset-td-br-3  .reset-td-br-4 role="presentation" }

#### Beispielanfrage:

`POST: https://rest.iad-01.braze.com/partners/[partner_name]/cohorts`
```
{
	"partner_api_key" : "123456-1234-1234-12345678",
	"client_secret" : "234567-2345-2345-23456789",
	"cohort_id" : "[some unique identifier generated by the partner]",
	"name" : "Name of the cohort that will appear in the Braze dashboard",
	"created_at" : "2021-01-21T19:20:30+05:00"
}
```

### Endpunkt der Benutzerkohorte

Mit dem Endpunkt Benutzerkohorte können Sie angeben, welche Benutzer zu einer bestimmten Kohorte hinzugefügt oder aus dieser entfernt wurden. Dieser Endpunkt sollte aufgerufen werden, wenn eine Kohorte aufgefrischt wird. Nur Benutzer, die der Kohorte neu beigetreten sind oder die Kohorte seit der letzten Aktualisierung verlassen haben, sollten an Braze gesendet werden.

| Feld | Typ | Erforderlich | Anmerkungen |
| ----- | ---- | -------- | ----- |
| `partner_api_key` | String | Ja | Partnerspezifischer API-Schlüssel, der bei allen Anfragen von Partnern an Braze verwendet wird. Dieser Schlüssel ist clusterspezifisch (siehe [Partner-API-Schlüssel](#partner-api-key)), so dass die Integration den Cluster kennen muss, in den die Kohorten geschrieben werden. |
| `client_secret` | String | Ja | Datenimportschlüssel für den Kunden, zu dessen Kohorte dies gehört. |
| `cohort_id` | String | Ja | Identifikator für die Kohorte. Die Kennung sollte für den angegebenen Client eindeutig sein. |
| `cohort_changes` | Array von Objekten | Ja | Objekte können zwei Felder haben. Eine, `user_ids`, ist erforderlich und kann ein Array aus `external_ids`, `device_ids` und `aliases` sein. Jedes Element ist eine ID für einen Benutzer, dessen Status in der Kohorte sich geändert hat. Das zweite Feld, `should_remove`, ist ein optionaler Boolescher Wert, der angibt, ob die Benutzer in diesem Objekt aus der Kohorte entfernt werden sollen, anstatt sie hinzuzufügen. Die Voreinstellung ist false. Die maximale kombinierte Länge der Benutzer-IDs in einer einzigen Anfrage beträgt 1.000.<br/><br/>Identifizierte Benutzer können entweder über ihre `external_id` oder `alias` abgeglichen werden. Anonyme Benutzer können über ihre `device_id` abgeglichen werden. Wenn Sie eine Geräte-ID für einen identifizierten Benutzer eingeben, wird Braze diesen Benutzer nicht hinzufügen oder entfernen. Sie müssen externe IDs oder Aliasnamen für identifizierte Benutzer verwenden. |
{: .reset-td-br-1 .reset-td-br-2 .reset-td-br-3  .reset-td-br-4 role="presentation" }

#### Beispielanfrage:

`POST: https://rest.iad-01.braze.com/partners/[partner_name]/cohorts/users`
```
{
	"partner_api_key" : "123456-1234-1234-12345678",
	"client_secret" : "234567-2345-2345-23456789",
	"cohort_id" : "[some unique identifier generated by the partner]",
	"cohort_changes" : "[
	   {"user_ids": ["test_user_1", "test_user_2"]}
	]"
}
```

## Ratenbegrenzung

Zusätzlich zu den maximal 1.000 Benutzer-IDs pro Anfrage im Benutzerkohorten-Endpunkt sind diese Endpunkt-Anfragen auf 250.000 Anfragen pro Stunde begrenzt.

## Kohortenfilter

Braze wird einen Filter hinzufügen, der es einem Dashboard-Benutzer ermöglicht, Benutzer aus einer Zielgruppe ein- oder auszuschließen, wenn sie zu einer Partnerkohorte gehören. Der Filter bietet eine Dropdown-Liste mit den Namen aller Kohorten, die Braze für diesen Kunden kennt. Dieser Filter ist nur für Kunden sichtbar, mit denen sich Partner und Braze auf diese Integration geeinigt haben.

## Fehlersuche

In der folgenden Tabelle finden Sie spezielle Fehlercodes für die Endpunkte von Cohort Import und Hinweise zur Fehlerbehebung.

| Fehler Code | Beschreibung |
| ----- | ---- |
| `400` | `cohort_id` muss eine gültige Zeichenkette sein |
|  | `cohort_changes` muss ein Array von Objekten sein, von denen jedes mit dem Schlüssel `user_ids` und/oder `device_ids` auf ein Array von Strings abgebildet wird, oder ein `aliases` Objekt |
|  | Pro Anfrage sind nur 1.000 `user_ids`, `device_ids`, und `aliases` erlaubt. |
|  | `name` muss eine nicht leere Zeichenkette sein |
|  | `created_at` muss eine gültige Zeit als [ISO-8601-String](https://en.wikipedia.org/wiki/ISO_8601) sein |
| `401` | Ungültiger Partner-API-Schlüssel |
|  | Ungültiges Client-Geheimnis |
|  | Partner nicht aktiviert für Kunde mit Kundengeheimnis: **<Kundengeheimnis>** |
|  | Unbefugter Zugriff |
| `423` | Ressource gesperrt |
{: .reset-td-br-1 .reset-td-br-2 role="presentation" }

Weitere Informationen zur Fehlerbehebung finden Sie im Abschnitt [Fehler und Antworten]({{site.baseurl}}/api/errors/), in dem die verschiedenen Fehler und Serverantworten behandelt werden, die bei der Verwendung der Braze-API auftreten können.
