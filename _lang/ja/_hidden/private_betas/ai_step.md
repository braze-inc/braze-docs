---
nav_title: AIステップ
article_title: AIステップ
permalink: /ai_step/
description: "この参考記事では、キャンバスAIのステップをカバーしている。"
Tool:
  - Canvas
hidden: true
---

# AIステップ

> CanvasのAIステップは、ChatGPTを活用し、ユーザーが生成したインプット（アンケートのフィードバックなど）を解釈し、適切なレスポンスを決定し、メッセージをトリガーすることで、パーソナライズされたマーケティングを自動化する。ChatGPTはサードパーティのOpenAIによって運営されている。

{% alert note %}
AIステップは現在ベータ機能として提供されている。このベータトライアルへの参加に興味がある場合は、カスタマーサクセスマネージャーにお問い合わせください。
{% endalert %}

## AIステップを作成する {#create-ai-step}
 
1. キャンバスに新しいステップを追加し、**AIステップを**選択する。<br><br>![キャンバスビルダーのAIステップ][1]{: style="max-width: 30%;"}<br><br>
2. ユーザーのさまざまなアクションにどのように反応するかをAIに指示するプロンプトを作成する。レスポンスには、カスタム属性の更新やメッセージの送信などがある。このプロンプトは、リキッドを使用して、異なるユーザー属性や入力に基づいて異なる応答出力を割り当てることができる。<br><br>同じキャンバス内で将来のメッセージをパーソナライズするために使用できる出力を割り当てるには、特定の名前（たとえば、"メッセージ "と "センチメントスコア"）を持つ変数を保存するプロンプトを作成する。<br><br> ![AIステップの設定で使用されるAIプロンプトのサンプルは、生成されたセンチメントスコアに基づいてパーソナライズされたメッセージを送信する。この例は、「顧客感情の反応」のセクションに記載されている。][2]<br><br>
3. **プレビュー・**タブを使って、特定のユーザーに対してAIがどのような出力をするかをテストする。<br><br> ![AIステップ設定のプレビュータブに、AIが生成したパーソナライズされたメッセージが表示されている。3つのパラメーター：キャメロンというファーストネーム、シューズという商品名、そして "comfy but my shoe lace already broke "というテキスト。][3]

## Liquidを使ってAIの出力を参照する
リキッドロジック`{% raw %}{{ai_step_output.${key_name}}}{% endraw %}` を挿入することで、後のステップでAI出力を参照する。AIステップのプロンプト内で`key_name` 。

例えば、変数 "message "と "sentiment score "を使えば、`{% raw %}{{ai_step_output.${message}}}{% endraw %}` 、同じCanvasの次のメッセージをパーソナライズすることができる。

また、ユーザー更新キャンバス・ステップを使用して、AIステップの出力をカスタム属性としてログに記録することもできる（例えば、`{% raw %}{{ai_step_output.${sentiment_score}}}{% endraw %}` ）。出力がカスタム属性として保存されていない場合、同じキャンバスの後続ステップ以外の場所では使用できない。

## AIステップの統計

AIステップは以下のステップレベルのステータスを持つ：

- **次のステップに進む：**キャンバスの次のステップに進んだユーザー数
- **キャンバスを出た：**あなたのAIステップが最後のステップであったため、キャンバスを終了したユーザーの数
- **出力は成功した：**AIステップが正常に出力を生成したユーザー数
- **出力に失敗した：**AIステップが出力に失敗したユーザーの数。この場合でも、ユーザーは後続のステップに進む。

### AIステップのアウトプットを理解する

BrazeがAIステップの出力を破棄し、顧客を次のステップに送るシナリオがいくつかある：
- 出力が1,024文字を超える場合
- 出力がJSONでない場合
- 不適切なユーザー作成コンテンツにフラグを立てるOpenAIの[モデレーション](https://platform.openai.com/docs/guides/moderation/overview)要件に、プロンプトが不合格になった場合

## AIステップの使用例

### 顧客感情の回答

[AIステップの作成](#create-ai-step)」の例で示したように、顧客フィードバックから生成されたセンチメント・スコアに基づいて、AIにフォローアップ・メッセージを送信させることができる。
- ポジティブなセンチメントスコア - ユーザーにレビューを残すよう求めるプッシュ通知をトリガーする
- 中程度のセンチメントスコア - 追加のヘルプが必要かをユーザーに尋ねるメールをトリガーする。
- センチメントスコアが低い - ウェブフックをトリガーし、ユーザーヘルプデスクに通知する。

#### AIプロンプトの例

この例は、[AIの作成ステップで](#create-ai-step)使用した。

ある顧客が"`{% raw %}{{canvas_entry_properties.${product_name}}}{% endraw %}`"を購入し、"`{% raw %}{{canvas_entry_properties.${text}}}{% endraw %}`"という商品感想を述べた。センチメントスコアを0～100の整数値で作成する。そして、パーソナライズされたメッセージを作成する。これは、"メッセージ "と "センチメント・スコア "という2つの変数を返すはずだ。

### 調査のフォローアップ

アプリ内またはブラウザ内で自由回答欄を設けたアンケートを実施する場合、AIステップを使って自由回答を分析し、適切なフォローアップを行うことができる。 

例えば、化粧品販売店が「今年のビューティー・アワードにノミネートしたい製品は何ですか」というアンケートを実施する場合、ユーザーの好きな製品タイプやブランドを特定して属性を割り当てるプロンプトを使用し、このデータに基づいて今後のコンテンツをパーソナライズすることができる。

#### AIプロンプトの例

ユーザーの回答から好きなブランドを特定する。そして、アンケートに答えてくれたユーザーに感謝し、Beauty Expertsも彼らの好きなブランドを愛していることに言及するメッセージを作成する。これは2つの変数、"message "と "favorite brand "を返すはずだ。

![AIステップ設定のプレビュータブには、「エスティローダーのフェイスクリームが好き」というアンケートの回答パラメータに対して、AIが生成したパーソナライズされたメッセージが表示されている。][4]

### 行動主導の提言

顧客はAIにユーザーの行動を分析し、推薦メッセージを送るよう依頼することができる。 

例えば、ユーザーの最近の購入履歴50件を分析するプロンプトを作成し、最もよく購入したカテゴリーを新しいカスタム属性として設定することができる。そして、各ユーザーの好きなカテゴリーにパーソナライズされたおすすめメールを送ることができる。

#### AIプロンプトの例

ある顧客が次の商品を購入した： "`{% raw %}{{custom_attribute.${Products Purchased}}}{% endraw %}`".ユーザーが最も購入した商品カテゴリーを特定する。これは、"最も購入されたカテゴリー "の新しい変数を返すはずである。

![AIステップ設定のプレビュータブに、最も購入されたカテゴリのパラメータとしてAIが生成した変数「本」が表示されている。][5]

## レート制限

1社につき毎分10リクエスト（RPM）の制限がある。つまり、どのAIステップでも、1分間に最大10人のユーザーがそのステップを受けることができ、10人を超えたユーザーは自動的に次のステップに進む。次の分が始まると、ユーザーは再びAIステップを受けることができるが、レート制限を発動した以前のユーザーは再試行されない。

## AIステップの制限

- この機能はGPT-3.5を活用している。
- この機能は、Braze OpenAI APIキーを使用する。自分のOpenAI APIキーは使えない。
- 1ワークスペースあたり毎分5リクエスト（RPM）、1社あたり10RPMの制限がある。
- この機能はHIPAAに準拠していないため、個人を特定できる情報（PII）や保護されるべき医療情報（PHI）を送信してはならない。

## データはどのように使用されて、OpenAI に送信されるのですか?

メッセージ内容を分析して作成するために、BrazeはOpenAIのAPI Platformにプロンプトを送信する。BrazeからOpenAIに送信されるクエリはすべて匿名化される。つまり、OpenAIは、ユーザーが提供するメッセージコンテンツに一意に特定できる情報が含まれていない限り、クエリが誰から送信されたかを特定することはできない。[OpenAI の API プラットフォームコミットメント](https://openai.com/policies/api-data-usage-policies)に詳述されているように、Braze 経由で OpenAI の API に送信されたデータは、モデルのトレーニングや改善には使用されず、30日後に削除されます。[使用ポリシー](https://openai.com/policies/usage-policies)など、お客様に関連する OpenAI のポリシーを必ず順守してください。Braze は AI が生成したコンテンツに関していかなる種類の保証も行いません。 

[1]: {% image_buster /assets/img/ai_step1.png %}
[2]: {% image_buster /assets/img/ai_step2.png %}
[3]: {% image_buster /assets/img/ai_step3.png %}
[4]: {% image_buster /assets/img/ai_step4.png %}
[5]: {% image_buster /assets/img/ai_step5.png %} 