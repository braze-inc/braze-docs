---
nav_title: Snowflakeデータ共有
hidden: true
---

# Snowflake データシェアリング統合

> Snowflake Data Shareが統合方法として使用される場合、Brazeが顧客に代わってSnowflakeインスタンスに共有をプロビジョニングする。この共有には、すべてのメッセージのエンゲージメントとユーザー行動のイベントが自動的に含まれる。

顧客が Snowflake データシェア資格を購入した後、シェアは顧客ごとにプロビジョニングされます。顧客がデータ共有を要求すると、Brazeは顧客のワークスペースに共有を追加し、顧客はセルフサービスUIを使って関連するパートナーのSnowflakeアカウントデータを追加できる。

![]({% image_buster /assets/img/snowflake.png %})

共有がプロビジョニングされると、すべてのデータは受信データ共有としてSnowflakeインスタンス内からすぐにアクセスできるようになる。

![]({% image_buster /assets/img/snowflake2.png %})

Snowflakeインスタンス内では、リージョンごとに1つのシェアが表示される。各テーブルには `app_group_id` という列があり、これは実質的な Braze のテナントキーです。新しい顧客が同じリージョン内のシェアに追加されると、この顧客は既存のテーブル内では異なる `app_group_ids` として表示されます。

{% alert important %}
Braze は現在、すべてのユーザーレベルのデータを Snowflake AWS US East-1 および EU-Centra (フランクフルト) リージョンでホストしています。Braze はクロスリージョンで共有できますが、`US-EAST-1` および/または `EU-CENTRAL-1` と共有すると、これは顧客にとって最もコスト効率が高くなります。
{% endalert %}

{% alert tip %}
[未加工のテーブル・スキーマは]({{site.baseurl}}/assets/download_file/data-sharing-raw-table-schemas.txt?ffbc5f5ca7092bc9ae26268aa0e711df)こちらからダウンロードするか、スノーフレーク・マーケットプレイスで入手可能な[サンプル・イベント・データ](https://app.snowflake.com/marketplace/listing/GZT0Z5I4XY0/braze-braze-user-event-demo-dataset)・セットを使用して、共有されるイベントに慣れることができる。
{% endalert %}

## 重複イベントを処理する

重複は予想されるが、すべてのイベントはIDカラムという一意の識別子を持っている。`select distinct(id)` を実行すると重複を解消できます。

## 破壊的な変更と非破壊的な変更

### 非破壊的な変更

非破壊的な変更はいつでも発生する可能性があり、一般的に追加の機能を提供します。非破壊的な変更の例には次のものがあります。
- 新しいテーブルまたはビューを追加する
- 既存のテーブルやビューにカラムを追加する

{% alert important %}
新しい列の追加は非破壊的な変更と見なされるため、Braze では `SELECT *` クエリを使用する代わりに、各クエリで関心のある列を明示的に列挙することを強くお勧めします。または、列に明示的に名前を付けるビューを作成してから、テーブルではなくそれらのビューを直接クエリすることもできます。
{% endalert %}

### 破壊的な変更

可能な場合には、破壊的な変更の前に通知を行い、移行期間を設けます。破壊的な変更の例には次のものがあります。
- テーブルまたはビューを削除する
- 既存のテーブルやビューからカラムを削除する
- 既存のカラムのタイプまたはヌル可能性を変更する

## 一般データ保護規則 (GDPR) への準拠

Brazeが保存するほぼすべてのイベント記録には、ユーザーの個人を特定できる情報（PII）を表すフィールドがいくつか含まれている。いくつかのイベントには、電子メールアドレス、電話番号、デバイスID、言語、性別、位置情報が含まれることがある。ユーザーの忘れ去り要求がBrazeに提出された場合、Brazeは、そのユーザーに属するイベントのPIIフィールドを無効にする。こうすることで、その出来事の歴史的記録を削除することはないが、その出来事を特定の個人に結びつけることはできなくなる。
