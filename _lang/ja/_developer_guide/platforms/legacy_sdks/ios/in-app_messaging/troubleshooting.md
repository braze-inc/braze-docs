---
nav_title: トラブルシューティング
article_title: iOS 向けアプリ内メッセージングのトラブルシューティング
platform: iOS
page_order: 7
description: "このリファレンス記事では、iOS のアプリ内メッセージのトラブルシューティングに関する潜在的なトピックを取り上げます。"
channel:
  - in-app messages

noindex: true
---

{% multi_lang_include deprecations/objective-c.md %}

# アプリ内メッセージのトラブルシューティング

## インプレッション

#### インプレッション分析やクリック分析が記録されていない

メッセージ表示またはクリックアクションを手動で処理するようにアプリ内メッセージデリゲートを設定している場合は、アプリ内メッセージのクリック数とインプレッション数を手動で記録する必要があります。

#### インプレッションが予想より低い

トリガーはセッション開始時にデバイスへの同期に時間がかかるため、ユーザーがセッション開始直後にイベントや購入を記録すると競合状態が発生する可能性があります。考えられる回避策の 1 つは、キャンペーンを変更してセッションの開始をトリガーし、目的のイベントまたは購入をセグメント化することです。なお、イベント発生後の次回セッション開始時にアプリ内メッセージが配信されることに注意してください。

## 予期したアプリ内メッセージが表示されなかった

ほとんどのアプリ内メッセージの問題は、配信と表示の 2 つの主要なカテゴリに分けることができます。予想されるアプリ内メッセージがデバイスで表示されない原因をトラブルシューティングするには、まず [[アプリ内メッセージがデバイスに配信された](#troubleshooting-in-app-message-delivery)] ことを確認してから [[メッセージ表示のトラブルシューティング](#troubleshooting-in-app-message-display)] を行う必要があります。

### アプリ内メッセージ配信 {#troubleshooting-in-app-message-delivery}

SDK はセッション開始時に Braze サーバーからアプリ内メッセージを要求します。アプリ内メッセージがデバイスに配信されているかどうかを確認するには、アプリ内メッセージが SDK によってリクエストされ、Braze サーバーによって返されていることを確認する必要があります。

#### メッセージが要求され、返されたかどうかを確認する

1. ダッシュボードに[テストユーザー]({{ site.baseurl }}/user_guide/administrative/app_settings/developer_console/internal_groups_tab/#adding-test-users) ]として追加する。
2. ユーザーを対象としたアプリ内メッセージキャンペーンを設定します。
3. アプリケーションで新しいセッションが発生することを確認します。
4. event user logs]({{ site.baseurl }}/user_guide/administrative/app_settings/developer_console/event_user_log_tab/#event-user-log-tab) ] を使って、デバイスがセッション開始時にアプリ内メッセージを要求していることを確認する。テストユーザーのセッション開始イベントに関連付けられた SDK リクエストを見つけます。
  - トリガーされたアプリ内メッセージをリクエストするためのアプリであれば、[**レスポンスデータ**] の [**リクエスト済みレスポンス**] フィールドに `trigger` が表示されます。
  - アプリが元のアプリ内メッセージをリクエストするためのものだった場合、[**レスポンスデータ］**] の [**リクエスト済みレスポンス**] フィールドに `in_app` が表示されます。
5. event user logs]({{ site.baseurl }}/user_guide/administrative/app_settings/developer_console/event_user_log_tab/#event-user-log-tab) ] を使って、正しいアプリ内メッセージがレスポンスデータで返されているかどうかをチェックする。<br>![]({% image_buster /assets/img_archive/event_user_log_iams.png %})

#### リクエストされていないメッセージのトラブルシューティング

アプリ内メッセージがリクエストされていない場合、アプリ内メッセージはセッション開始時にリフレッシュされるため、アプリがセッションを正しくトラッキングしていない可能性があります。また、アプリのセッションタイムアウトセマンティクスに基づいて、アプリが実際にセッションを開始していることを確認してください:

![SDKリクエストは、成功したセッション開始イベントを表示するイベントユーザーログで見つかった。]({% image_buster /assets/img_archive/event_user_log_session_start.png %})

### メッセージが返されない問題のトラブルシューティング

アプリ内メッセージが返されない場合、キャンペーンターゲティングの問題が発生している可能性があります。

- セグメントにユーザーが含まれていない。
  - ユーザーの[\*\*エンゲージメント**]({{ site.baseurl }}/user_guide/engagement_tools/segments/using_user_search/#engagement-tab) ]タブを確認し、**セグメンテーションの**下に正しいセグメンテーションが表示されているか確認する。
- ユーザーが以前にアプリ内メッセージを受け取ったことがあり、再度受け取る資格がなかった。
  - **キャンペーンコンポーザーの** **配信**ステップにある[キャンペーンの再適格設定]({{ site.baseurl }}/user_guide/engagement_tools/campaigns/building_campaigns/delivery_types/reeligibility/) ] をチェックし、再適格設定があなたのテスト設定と一致していることを確認する。
- ユーザーがキャンペーンのフリークエンシーキャップに達した。
  - キャンペーン[フリークエンシーキャップ設定]({{ site.baseurl }}/user_guide/engagement_tools/campaigns/building_campaigns/rate-limiting/#frequency-capping) を確認し、テスト設定と一致していることを確認する。
- キャンペーンにコントロールグループが存在した場合、ユーザーがコントロールグループに分類された可能性があります。
  - キャンペーンバリアントが [**制御**] に設定されている受信キャンペーンバリアントフィルターでセグメントを作成し、ユーザーがそのセグメントに分類されたかどうかを確認することで、これが発生したかどうかを確認できます。
  - 統合テスト目的でキャンペーンを作成する場合は、コントロールグループの追加をオプトアウトしてください。

### アプリ内メッセージ表示{#troubleshooting-in-app-message-display}

アプリがアプリ内メッセージのリクエストと受信に成功しているのに表示されない場合は、デバイス側のロジックによって表示が妨げられている可能性があります。

- トリガーされたアプリ内メッセージは、[トリガー間の最小時間間隔]({{site.baseurl}}/developer_guide/platform_integration_guides/ios/in-app_messaging/in-app_message_delivery/#minimum-time-interval-between-triggers) (デフォルトは30秒) に基づいてレート制限されます。
- アプリ内メッセージ処理をカスタマイズするようにデリゲートを設定している場合は、デリゲートがアプリ内メッセージ表示に影響していないことを確認してください。
- 画像のダウンロードに失敗すると、画像付きのアプリ内メッセージが表示されなくなります。`SDWebImage` フレームワークが正しく統合されていない場合、画像のダウンロードは常に失敗します。画像のダウンロードに失敗していないか、デバイスのログを確認してください。
- 端末の向きがアプリ内メッセージで指定された向きと一致しなかった場合、アプリ内メッセージは表示されません。デバイスの向きが正しいことを確認してください。


