### 匿名ユーザー履歴の自動保存

| 識別コンテキスト | 保存行動 |
| ---------------------- | -------------------------- |
| ユーザーが過去に識別されて**いない。 | 匿名の履歴は、本人確認時にユーザープロファイルと**統合される**。 |
| ユーザーがアプリ内または API 経由で事前に識別**されている** | 匿名履歴は、本人確認時にユーザープロファイルと**統合されない**。 |
{: .reset-td-br-1 .reset-td-br-2}

匿名ユーザーを識別した場合の詳細については、[識別子ユーザープロファイルを]({{site.baseurl}}/user_guide/data_and_analytics/user_data_collection/user_profile_lifecycle/#identified-user-profiles)参照のこと。

### その他の注意事項とベストプラクティス

次のことに注意してください。

- アプリを複数のユーザーが使用する場合、各ユーザーに一意の識別子を割り当てて追跡することができる。
- ユーザーIDを設定した後、そのユーザーを匿名プロファイルに戻すことはできない。
- ユーザーがログアウトしたときにユーザーIDを変更しないこと。これは、デバイスとユーザープロファイルを分離する可能性があるためである。
  - その結果、以前にログアウトしたユーザーを再エンゲージメントメッセージでターゲットにすることはできません。同じデバイスに複数のユーザーが存在することが予想されるものの、アプリがログアウト状態の間にそのうちの1ユーザーのみをターゲットにする場合は、ログアウト中にターゲットにするユーザー ID を個別に追跡し、アプリのログアウトプロセスの中でそのユーザー ID に戻すことをお勧めします。デフォルトでは、最後にログインしたユーザーのみがアプリからのプッシュ通知を受け取る。
- 特定されたユーザーから別のユーザーへの切り替えは、比較的コストのかかる操作です。
  - ユーザー切り替えを要求すると、前のユーザーの現在のセッションは自動的に閉じられ、新しいセッションが開始されます。Brazeは、新しいユーザーに対して、アプリ内メッセージやその他のBrazeリソースのデータ更新要求を自動的に行う。

{% alert tip %}
ユーザーIDとして一意な識別子のハッシュを使用する場合は、ハッシュ関数への入力を正規化していることを確認すること。例えば、メールアドレスのハッシュを使う場合は、入力から先頭と末尾の空白を取り除き、ローカライゼーションを考慮していることを確認する。
{% endalert %}