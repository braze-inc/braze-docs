---
nav_title: メッセージ 
article_title: メッセージ 
alias: "/message_step/"
page_order: 5
page_type: reference
description: "この記事では、キャンバスのメッセージングステップを使用してスタンドアロンメッセージを作成する方法について説明します。"
tool: Canvas

---

# メッセージ 

> メッセージステップを使用すると、キャンバスフロー内の任意の場所にスタンドアロンメッセージを追加できます。

![][1]{: style="float:right;max-width:25%;margin-left:15px;"}

## メッセージを作成する

メッセージコンポーネントを作成するには、まずキャンバスにステップを追加します。サイドバーからコンポーネントをドラッグ＆ドロップするか、ステップの一番下にある <i class="fas fa-plus-circle"></i> プラスのボタンをクリックし、[**メッセージ**] を選択します。 

### メッセージを設定する

メッセージステップに入ったすべてのユーザーは、次のいずれかの条件が満たされると次のステップに進みます。
\- 任意のメッセージが送信される
\- メッセージにフリークエンシーキャップが適用され、送信されない
\- メッセージが中断される
\- チャネルからユーザーに到達できないため、メッセージが送信されない

![メッセージチャネルを選択して配信設定をカスタマイズするオプションを含む、キャンバスメッセージコンポーネントのメッセージ設定。][2]{: style="max-width:75%;"}

{% raw %}
アクションベースのキャンバスが SMS メッセージの受信によってトリガーされた場合、キャンバスの最初のメッセージステップで SMS プロパティを参照できます。たとえば、メッセージステップでは、`{{sms.${inbound_message_body}}}` または `{{sms.${inbound_media_urls}}}` を使用できます。
{% endraw %}

### 配信設定を編集する

メッセージコンポーネントには、インテリジェント配信、サイレント時間のオーバーライド、および配信検証の設定も含まれます。ユーザーのプロファイルに、最適な時間を計算するのに十分なデータがない場合、フォールバックのオプションとして[インテリジェントタイミング]({{site.baseurl}}/user_guide/sage_ai/intelligence/intelligent_timing/)を有効にできます。Braze では、ユーザーがメッセージステップに入ってから実際のメッセージを送信するまでの遅延の追加チェックとして、インテリジェントタイミングと[レート制限]({{site.baseurl}}/user_guide/engagement_tools/campaigns/building_campaigns/rate-limiting/#rate-limiting-and-frequency-capping/)を有効にすることを推奨しています。

[**配信設定**] タブで [**インテリジェントタイミングを使用**] を選択します。ここでは、使用率が最も高い時間または特定のフォールバック時間を選択できます。サイレント時間が有効になっている場合は、メッセージステップでこの設定をオーバーライドすることもできます。

配信検証では、メッセージ送信時にオーディエンスが配信基準を満たしていることを確認する追加のチェックを行います。この設定は、サイレント時間、インテリジェントタイミング、レート制限のいずれかがアクティブになっている場合に推奨されます。メッセージの送信時に検証するセグメントやフィルターを追加できます。メッセージステップに設定された配信検証を満たさないユーザーは、このステップでキャンバスから退出します。

![メッセージコンポーネント設定の「配信設定」タブ。サイレント時間が有効になり、「インテリジェントタイミングを使用」チェックボックスがオンになり、最適なタイミングでメッセージが配信されます。配信検証が有効になり、メッセージ送信時にオーディエンスが検証されます。][4]{: style="max-width:80%;"}

### キャンバスエントリのプロパティ

キャンバスエントリのプロパティは、キャンバスの作成のエントリスケジュールステップで設定され、キャンバスにユーザーを入れるトリガーを指定します。これらのプロパティは、API トリガーキャンバスのエントリペイロードのプロパティにもアクセスできます。`canvas_entry_properties` オブジェクトのサイズ上限は 50 KB であることに注意してください。 

{% alert note %}
特にアプリ内メッセージチャネルでは、以前の早期アクセスの一環として元のエディターで永続的なエントリプロパティを有効にしている場合、キャンバスフローと元のキャンバスエディターでのみ `canvas_entry_properties` を参照できます。
{% endalert %}

#### キャンバスフロー

キャンバスフローのメッセージングの場合、エントリプロパティは任意のメッセージステップの Liquid で使用できます。これらのエントリプロパティを参照する場合は、{% raw %} ``canvas_entry_properties${property_name}`` {% endraw %} という Liquid を使用します。このように使用するには、イベントがカスタムイベントまたは購入イベントでなければなりません。

これらのエントリプロパティを参照する場合は、{% raw %} ``canvas_entry_properties${property_name}`` {% endraw %} という Liquid を使用します。このように使用するには、イベントがカスタムイベントまたは購入イベントでなければならないことに注意してください。

{% raw %}
例えば、`\"canvas_entry_properties\" : {\"product_name\" : \"shoes\", \"product_price\" : 79.99}` というリクエストを考えてみます。`{{canvas_entry_properties.${product_name}}}` という Liquid でメッセージに「靴」という単語を追加できます。
{% endraw %}

また、任意のメッセージステップで[永続エントリプロパティ]({{site.baseurl}}/user_guide/engagement_tools/canvas/create_a_canvas/canvas_persistent_entry_properties/)を利用して、キャンバスワークフロー全体を通じてパーソナライズされたステップにユーザーを誘導することもできます。

#### 元のワークフロー

元のエディターで作成されたキャンバスの場合、`canvas_entry_properties` はキャンバスの最初のフルステップでのみ参照できます。

### イベントのプロパティ

イベントのプロパティとは、カスタムイベントや購入に対して設定するプロパティのことです。これらの `event_properties` は、アクションベースの配信を伴うキャンペーンおよびキャンバスで使用できます。 

#### キャンバスフロー

キャンバスフローでは、カスタムイベントと購入イベントのプロパティを[アクションパス]({{site.baseurl}}/user_guide/engagement_tools/canvas/canvas_components/action_paths/)ステップに続く任意のメッセージステップの Liquid で使用できます。キャンバスフローの場合、これらの `event_properties` を参照するときは、`` {% raw %} {{event_properties.${property_name}}} {% endraw %}`` という Liquid を使用します。メッセージコンポーネントでこのように使用するには、これらのイベントがカスタムイベントまたは購入イベントである必要があります。

{% alert important %}
`event_properties` は、キャンバスフローのアクションパスと独立して使用することはできません。
{% endalert %}

アクションパスに続く最初のメッセージステップでは、そのアクションパスで参照されるイベントに関連する `event_properties` を使用できます。このアクションパスステップとメッセージステップの間に、他のステップ (別のアクションパスやメッセージステップではない) があってもかまいません。なお、`event_properties` にアクセスできるのは、メッセージステップが、アクションパスステップの「その他のユーザー」以外のパスに遡ることができる場合のみです。

#### 元のワークフロー

`event_properties` は、フルステップがスケジュールされている場合でも、元のワークフローを使用したアクションベースのキャンバスの最初のフルステップで使用できます。 

{% alert important %}
キャンバスフローおよび元のエディターでは、リードメッセージステップで `event_properties` を使用することはできません。代わりに、`canvas_entry_properties` を使用するか、`event_properties` を含むメッセージステップの前に、対応するイベントを持つアクションパスステップを追加する必要があります。
{% endalert %}

詳細と例については、「[キャンバスエントリのプロパティとイベントプロパティ]({{site.baseurl}}/user_guide/engagement_tools/canvas/create_a_canvas/canvas_entry_properties_event_properties/)」を参照してください。


## 分析

メッセージコンポーネントの指標の定義については、次の表を参照してください。 

| 指標 | 説明 |
| --- | --- |
| エントリ | コンポーネントに入った回数。キャンバスに再適格性があり、ユーザーがメッセージコンポーネントに 2 回入った場合、2 つのエントリが記録されます。 |
| 次のステップに進行済み | キャンバスの次のステップに進んだエントリの数。 |
| 送信数 | コンポーネントが送信したメッセージの総数。キャンバスの再適格性で、ユーザーがメッセージコンポーネントに 2 回入った場合、2 つのエントリが記録されます。 |
| ユニーク受信者数 | このコンポーネントからメッセージを受信したユーザーの数。 |
| 1 次コンバージョンイベント | Braze キャンペーンから受信したメッセージの操作後または表示後に、定義されたイベントが発生した回数。このイベントは、キャンペーンを構築するときに定義します。 |
| 収益 | 設定された 1 次コンバージョン期間内のキャンペーン受信者からのドル単位の総収益。 |
{: .reset-td-br-1 .reset-td-br-2}

![][3]{: style="max-width:20%;"}


[1]: {% image_buster /assets/img/canvas_components/message_step1.png %}
[2]: {% image_buster /assets/img/canvas_components/message_step2.png %}
[3]: {% image_buster /assets/img/canvas_components/message_step3.png %}
[4]: {% image_buster /assets/img/canvas_components/message_step4.png %}
