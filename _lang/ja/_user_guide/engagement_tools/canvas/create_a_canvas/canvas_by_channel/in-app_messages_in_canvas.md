---
nav_title: アプリ内メッセージ
article_title: キャンバスのアプリ内メッセージ
alias: "/canvas_in-app_messages/"
page_order: 2
page_type: reference
description: "この記事では、キャンバスに追加してリッチメッセージングを表示できるキャンバスのアプリ内メッセージに固有の機能とニュアンスについて説明します。"
tool: Canvas
channel: in-app messages

---

# キャンバスのアプリ内メッセージ

> アプリ内メッセージをキャンバスジャーニーの一部として追加して、顧客がアプリを利用したときにリッチメッセージングを表示できます。この記事では、キャンバスのアプリ内メッセージに固有の機能とニュアンスについて説明します。

次のセクションに進む前に、[キャンバスを作成]({{site.baseurl}}/user_guide/engagement_tools/canvas/create_a_canvas/create_a_canvas/)し、遅延とオーディエンスのオプションを設定しておく必要があります。 

キャンバスにアプリ内メッセージを追加できるようになりました。[メッセージ]({{site.baseurl}}/user_guide/engagement_tools/canvas/canvas_components/message_step/)ステップを追加し、**メッセージングチャネル**用の**アプリ内メッセージ**を選択します。遅延が発生し、オーディエンスのオプションがチェックされると、アプリ内メッセージが有効に設定されて、ユーザーがアプリを開いたときに表示されます。キャンバスのアプリ内メッセージは `start session` トリガーイベントでのみトリガーでき、キャンバスコンポーネント内のカスタムイベントではトリガーできません。

アクションによってエントリがトリガーされるキャンバスステップの場合、ユーザーがセッションの途中でキャンバスに入る可能性があります。ただし、前述したように、アプリ内メッセージは次のセッションが開始されるまでトリガーされず、これらのユーザーはセッション開始前にキャンバスに入る資格がないため、最初のアプリ内メッセージが見逃されます。

[メッセージがいつ期限切れになるか](#in-app-message-expiration)、どのような[昇進動作](#advancement-behavior-options)を行うかをカスタマイズできます。

## アプリ内メッセージの有効期限

アプリ内メッセージ作成画面でアプリ内メッセージの有効期限を選択できます。この間、アプリ内メッセージは有効期限が切れるまで表示されるのを待機します。アプリ内メッセージは送信後に一度だけ表示できます。

![][1]

| オプション | 説明 | 例 |
|---|---|---|
| 指定した期間が経過すると、メッセージが期限切れになる | 最初の方法では、ステップがユーザーで使用可能になった時点を基準にしてアプリ内メッセージを期限切れにすることができます。 | 例えば、有効期限が 2 日間のアプリ内メッセージは、ステップの延期期間が経過し、オーディエンスの選択肢がチェックされた後に使用可能になります。その後、2 日間(48 時間) 利用可能になり、その2 日間、ユーザー s がアプリを開封するとアプリ内メッセージが表示される場合があります。 |
| 指定した日付までにメッセージの有効期限が切れる | 2 番目のオプションでは、アプリ内メッセージが使用できなくなる特定の日時を選択できます。 | 例えば、特定の日時に終了するセールがある場合、このオプションを選択すると、セール終了時に関連するアプリ内メッセージがユーザーに表示されなくなります。 |
{: .reset-td-br-1 .reset-td-br-2 .reset-td-br-3 role="presentation" }

### ユースケース

ここでは、この機能をどのような場合に使用すべきかを説明します。Braze では、プロモーションキャンバスやオンボーディングキャンバスにこの機能を使用することを強くお勧めします。

{% tabs %}
  {% tab プロモーション %}

プロモーション、クーポン、セールには、多くの場合、ハードな有効期限があります。次のキャンバスは、購入を促すために、ユーザーに利用可能なプロモーションがあることを最も適切なタイミングで通知するよう設定されています。このプロモーションは、会社のタイムゾーンの 2019 年 2 月 28 日午前 11 時 15 分に期限切れになります。

<style type="text/css">
.tg td{word-break:normal;}
.tg th{word-break:normal;}
</style>

<table class="tg">
<thead>
  <tr>
    <th>キャンバスステップ</th>
    <th>遅延</th>
    <th>オーディエンス</th>
    <th>チャネル</th>
    <th>有効期限</th>
    <th>ユーザー昇進</th>
    <th>詳細</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td>1 日目: 50% 割引</td>
    <td>なし</td>
    <td>エントリ全員</td>
    <td>プッシュ</td>
    <td>N/A</td>
    <td>延期期間後にオーディエンスを昇進させる</td>
    <td>プロモーションについてユーザーに警告する最初のプッシュ通知。この目的は、プロモーションを利用するようにユーザーをアプリに誘導することです。</td>
  </tr>
  <tr>
    <td>アプリ内: 50% 割引</td>
    <td>なし</td>
    <td>エントリ全員</td>
    <td>アプリ内メッセージ</td>
    <td><b>有効期限:</b>2019 年 2 月 28 日午前 11 時 15 分 (会社時刻)</td>
    <td>アプリ内メッセージの表示</td>
    <td>ユーザーがアプリを開いたので、以前にプッシュメッセージがあったかどうかにかかわらず、このメッセージが表示されます。</td>
  </tr>
  <tr>
    <td>50% 割引リマインダー</td>
    <td>ユーザーが前のステップを受け取ってから 1 日後</td>
    <td>エントリ全員 <br><br><b>フィルター:</b>最終購入日が 1 週間以上前</td>
    <td>アプリ内メッセージ</td>
    <td><b>有効期限:</b>2019 年 2 月 28 日午前 11 時 15 分 (会社時刻)</td>
    <td>なし (キャンバスの最後のメッセージ)</td>
    <td>ユーザーは前のステップでアプリ内メッセージを受信しましたが、アプリを開いたにもかかわらず購入していません。<br><br>このメッセージは、プロモーションを利用して購入するユーザーをさらに引き付けることが目的です。</td>
  </tr>
</tbody>
</table>

ご覧のように、メッセージングとカスタマーエクスペリエンスの間に相違が生じないように、アプリ内メッセージはプロモーションの有効期限が切れると期限切れになります。

  {% endtab %}
  {% tab ユーザーオンボーディング %}

ユーザーの第一印象は、おそらく最も重要なインプレッションです。これによって今後アプリにアクセスするかどうかが決まります。ユーザーとの初期のコミュニケーションは適切なタイミングで行い、アプリに頻繁にアクセスするよう働きかけてアプリの使用を促進する必要があります。

<table class="tg">
<thead>
  <tr>
    <th>キャンバスステップ</th>
    <th>遅延</th>
    <th>オーディエンス</th>
    <th>チャネル</th>
    <th>有効期限</th>
    <th>ユーザー昇進</th>
    <th>詳細</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td>ウェルカムメール</td>
    <td>なし</td>
    <td>エントリ全員</td>
    <td>メール</td>
    <td>N/A</td>
    <td>延期期間後にオーディエンスを昇進させる</td>
    <td>プロジェクト、メンバーシップ、またはその他のオンボーディングプログラムにユーザーを歓迎する最初のメール。<br><br>これは、ユーザーをアプリに誘導してオンボーディングを開始してもらうことが目的です。</td>
  </tr>
  <tr>
    <td>3 ～ 6 日目のアプリ内メッセージ</td>
    <td>ユーザーが前のステップを受け取ってから 3 日後</td>
    <td>エントリ全員</td>
    <td>アプリ内メッセージ</td>
    <td><b>有効期限:</b>ステップが利用可能になってから 3 日後</td>
    <td>アプリ内メッセージが有効</td>
    <td>ユーザーがメールに基づいて行動しアプリにたどり着いた場合、ユーザーは希望するアプリ内メッセージを受け取り、オンボーディングとそれに関連する要件を続行またはリマインドします。</td>
  </tr>
  <tr>
    <td>5 日目のプッシュ通知 </td>
    <td>ユーザーが前のステップを受け取ってから 2 日後</td>
    <td>エントリ全員</td>
    <td>プッシュ</td>
    <td>N/A</td>
    <td>メッセージの送信</td>
    <td>ユーザーはアプリ内メッセージを受信した後、オンボーディングを続けるためのフォローアッププッシュ通知を受け取ります。</td>
  </tr>
</tbody>
</table>

ご覧のように、ユーザーがアプリにアクセスしてオンボーディングを開始したことを確認するために、プッシュメッセージはアプリ内メッセージの周りに配置されています。これにより、ユーザーがアプリにアクセスするのを思いとどまらせる迷惑なスパムや順序を間違えたメッセージングを防ぎ、代わりにユーザーがアプリを初めて利用するときにスムーズでわかりやすいエクスペリエンスを提供できます。

  {% endtab %}
{% endtabs %}

## 昇進動作のオプション

### キャンバスフロー

キャンバスフローでは、メッセージコンポーネントがステップに入るすべてのユーザーを自動的に進めます。メッセージの昇進動作を指定する必要はなく、全体的なステップの設定がより簡単になります。[**メッセージの送信時にユーザーを昇進させる**] オプションを実装する場合は、別の [[オーディエンスパス]({{site.baseurl}}/user_guide/engagement_tools/canvas/canvas_components/audience_paths/)] を追加して、前のステップを受信しなかったユーザーをフィルタリングします。

### 元のキャンバスエディター

{% alert important %}
2023 年 2 月 28 日以降、元のエディターを使用したキャンバスの作成や複製はできなくなりました。このセクションは、アプリ内メッセージを使ったステップの昇進動作の仕組みを理解するための参考にしてください。
{% endalert %}

元のエディターで作成されたキャンバスには、昇進動作、つまりキャンバスコンポーネントを段階的に進めるための基準を指定する必要があります。[アプリ内メッセージのみのステップ](#steps-iam-only)には、[複数のメッセージタイプを持つステップ](#steps-multiple-channels) (プッシュ、メールなど) とは異なる昇進オプションがあります。キャンバスフローワークフローのアプリ内メッセージの場合、このオプションは常にオーディエンスをすぐに昇進させるように設定されています。

アクションベースの配信は、アプリ内メッセージのあるキャンバスステップでは使用できません。アプリ内メッセージのあるキャンバスステップは、スケジュールする必要があります。代わりに、キャンバスコンポーネントでスケジュールされたメッセージがユーザーに送信された後、ユーザーが (開始セッションによってトリガーされて) 初めてアプリを開いたときに、キャンバスのアプリ内メッセージが表示されます。

1 つのキャンバス内に複数のアプリ内メッセージがある場合、ユーザーはそれらの個別のメッセージをそれぞれ受信するために複数のセッションを開始する必要があります。

{% alert important %}
アプリ内メッセージはキャンバスのイベントではトリガーできません。
{% endalert %}

![][2]

{% alert important %}
[**アプリ内メッセージが有効なときにユーザーを昇進させる**] を選択すると、ユーザーが後続のステップに移動した後も、アプリ内メッセージは有効期限が切れるまで利用可能になります。キャンバスの次のステップが配信されたときにアプリ内メッセージを有効にしたくない場合は、有効期限を後続のステップの遅延よりも短く設定してください。
{% endalert %}

#### 複数のチャネルを含むステップ {#steps-multiple-channels}

アプリ内メッセージと別のチャネルを含むステップには、以下の高度なオプションがあります。

| オプション | 説明 |
|---|---|---|
| メッセージ送信時のアドバンス | ユーザは、メール、Webhook、またはプッシュ通知を送信するか、アプリ内メッセージを表示して、キャンバス内の後続のステップに進む必要があります。 <br> <br>  アプリ内メッセージの有効期限が切れても、ユーザーにメール、Webhook、プッシュ通知が送信されていないか、アプリ内メッセージが表示されていない場合、ユーザーはキャンバスを退出し、次のステップに進みません。 |
| すぐにオーディエンスを次に進める | 延期期間が経過すると、メッセージを表示したかどうかにかかわらず、そのステップのオーディエンス全員が次のステップに進みます。 <br> <br> 次回のステップに進むには、ステップのSegment基準とフィルター基準を満たす必要があります。 |
{: .reset-td-br-1 .reset-td-br-2 role="presentation" }

![][3]

{% alert important %}
**Entire Audience**を選択した場合、ユーザーが次のステップsに移動した場合でも、有効期限が切れるまでアプリ内メッセージが使用可能になります。キャンバスの次のステップが配信されるときにこのアプリ内メッセージを有効にしない場合は、有効期限が後続のステップの延期期間よりも短いことを確認してください。
{% endalert %}

## アプリ内メッセージの優先順位

顧客がキャンバス内で同時に 2 つのアプリ内メッセージをトリガーする可能性があります。この場合、表示されるアプリ内メッセージが Braze により以下の優先順位に従って決定されます。キャンバスのさまざまなステップをドラッグすると、優先順位を変更できます。デフォルトでは、キャンバスバリアントの前のステップから順に表示されます。

![]({% image_buster /assets/img_archive/step_priority.png %}){: style="max-width:80%"}

キャンバスの [**送信設定**] セクションに移動して、キャンバスからのアプリ内メッセージを他のキャンバスやキャンペーンからのアプリ内メッセージよりも優先させることができます。

![]({% image_buster /assets/img_archive/canvas_send_settings.png %})

デフォルトでは、キャンバスコンポーネントの優先順位は「中」に設定され、最後に作成されたステップの相対的な優先順位が最も高く設定されます。キャンバスレベルとキャンペーンレベルの優先順位もデフォルトで「中」に設定され、最後に作成されたアイテムの相対的な優先順位がデフォルトで最も高く設定されます。

![]({% image_buster /assets/img_archive/canvas_priority.png %}){: style="max-width:85%"}

### アクティブなキャンバスの下書き

アクティブなキャンバスの下書きを編集する場合、**送信設定**内のアプリ内メッセージの優先順位の変更は、下書きに保存されません。これらの変更は、優先順位の並べ替えモーダルを閉じると、アクティブなキャンバスに直接適用されます。ただし、メッセージステップでは、ステップの設定がステップレベルで適用されるため、ユーザーが下書きを開始すると優先順位の並べ替えが更新されます。

## キャンバスのカスタムイベントプロパティ

アプリ内メッセージのあるキャンバスステップではアクションベースの配信を使用できないため、これらのステップではカスタムイベントプロパティを使用することもできません。キャンバスでイベントプロパティをテンプレート化する場合は、最初のキャンバスステップでイベントプロパティをカスタム属性として保存し、2 番目のステップでそのカスタム属性を使用してアプリ内メッセージをパーソナライズすることをお勧めします。


[1]: {% image_buster /assets/img/expires-after.png %} 「IAM ライブ」
[2]: {% image_buster /assets/img/iam-advancement-behavior.png %} 「IAM ライブ」
[3]: {% image_buster /assets/img/push-advancement-behavior.png %} 「IAM ライブ」
