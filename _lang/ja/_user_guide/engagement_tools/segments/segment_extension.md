---
nav_title: セグメントエクステンション
article_title: セグメントエクステンション
page_order: 3.1

page_type: tutorial
description: "この操作方法に関する記事では、セグメントエクステンションをセットアップして使用し、セグメンテーション機能を強化する方法について説明します。"
tool: Segments
---

# セグメントエクステンション

> Braze セグメンテーションを使用すると、そのユーザープロファイルの有効期間中に保存されたカスタムイベントや購入行動に基づいてユーザーのターゲットを設定できます。例としては、特定の時間以降に特定のカスタムイベントを実行したユーザーまたは実行していないユーザーを検索したり、これまでに購入した製品やサービスに費やした金額に基づいてユーザーをセグメント化したりすることが挙げられます。

セグメントエクステンションは、階層化イベントプロパティを使用したり、過去2年間 (730日間) のカスタムイベントプロパティや購入イベントプロパティをウィンドウ形式で集計したりできるオーディエンス定義です。たとえば、Braze セグメンテーションを使用すると、これまでの期間に特定の製品を購入したユーザーを見つけることができます。セグメントエクステンションを使用すると、過去2年間に特定の製品の特定の色を2回以上購入したユーザーにオーディエンスをさらに絞り込むことができます。セグメントエクステンションを作成するときに、オーディエンスを固定するか、毎日再生成するかを指定することもできます。

[アクションベースの配信][19] に階層化イベントプロパティを使用する場合、イベント処理はリアルタイムで行われるため、セグメントエクステンションは必要ありません。階層化カスタム属性も同様に、セグメントエクステンションを使用する必要はありません。

{% alert important %}
デフォルトでは、特定の時間に1つのワークスペースにつき25個のアクティブなセグメントエクステンションが割り当てられます。この制限を増やす必要がある場合は、Brazeカスタマーサクセスマネージャーに連絡して、ユースケースについて話し合ってください。
{% endalert %}

## ステップ 1 セグメントエクステンションに移動する

[**オーディエンス**] > [**セグメントエクステンション**] に移動します。

{% alert note %}
[古いナビゲーション]({{site.baseurl}}/navigation)を使用している場合は、[**エンゲージメント**] > [**セグメント**] > [**セグメントエクステンション**] でこのページを見つけることができます。
{% endalert %}

[セグメントエクステンション] テーブルから、[**エクステンションを新規作成**] をクリックし、セグメントエクステンションの作成方法を選択します。

- **シンプルなエクステンション:**ガイド付きフォームを使用して、単一のイベントに焦点を当てたセグメントエクステンションを作成します。
SQL を使用しない場合に最適です。
- **テンプレートを使用して始める:**Snowflake データを使用して、カスタマイズ可能なテンプレートで SQL セグメントを作成します。
- **増分更新:**過去2日間のデータを自動的に更新するか、必要に応じて手動で更新する Snowflake SQL セグメントを作成します。精度とコスト効率のバランスをとるのに最適です。
- **完全更新:**手動更新時にオーディエンス全体を再計算する Snowflake SQL セグメントを作成します。オーディエンスに関する完全な最新のビューが必要な場合に最適です。

![][20]{: style="max-width:50%"}

SQL を使用するエクスペリエンスを選択した場合の詳細は、[SQL セグメントエクステンション]({{site.baseurl}}/user_guide/engagement_tools/segments/sql_segments/)を参照してください。

「**簡易拡張**」を選択した場合は、以下のステップに進んでください。

## ステップ 2: セグメントエクステンションに名前を付ける

フィルタリングするユーザーのタイプを記述して、セグメントエクステンションに名前を付けます。これにより、このエクステンションをフィルターとしてセグメントに適用するときに、このエクステンションを簡単かつ正確に検出できます。

![「オンラインショッパーエクステンション - 90日」という名前のセグメントエクステンションで、「エクステンションを毎日再生成」チェックボックスが選択されている。][2]

## ステップ 3: 条件を選択する

ターゲティングの条件として、購入、メッセージエンゲージメント、カスタムイベントのいずれかを選択します。希望のイベントタイプ条件を選択したら、ユーザーリストでターゲットにする購入アイテム、メッセージインタラクション、または特定のカスタムイベントを選択します。次に、ユーザーがイベントを完了する必要がある回数 (より大きい、より小さい、または等しい) と期間を選択します。特にセグメントエクステンションの場合は、過去730日間 (2年間) までさかのぼることができます。

730日を超えるイベントデータに基づくセグメンテーションは、**セグメント**にある他のフィルターを使用して実行できます。期間を選択するときは、相対的な日付範囲 (過去 X 日間など)、開始日、終了日、または正確な日付範囲 (日付 A ～ B) を指定できます。

![][3]

### イベントプロパティのセグメンテーション

ターゲティングの精度を上げるには、[**プロパティフィルターを追加**] チェックボックスを選択します。これにより、購入またはカスタムイベントの特定のプロパティに基づいて掘り下げることができます。文字列、数値、ブール値、および時間オブジェクトに基づくイベントプロパティのセグメンテーションをサポートしています。

文字列プロパティの場合、複数の値を一度に入力できます。以下の例では、このフィルターは、ゴールド、シルバー、ブロンズのいずれかのステータスのユーザーを検索します。

![文字列プロパティに基づくセグメント化。][13.5]

![数値プロパティに基づくセグメント化。][13]

![ブール値プロパティに基づくセグメント化。][14]

![datetime オブジェクトに基づくセグメント化。][15]

[階層化イベントプロパティ]({{site.baseurl}}/user_guide/data_and_analytics/custom_data/custom_events/nested_objects/)に基づくセグメンテーションもサポートしています。

![階層化イベントプロパティに基づくセグメント化] [18]

セグメントエクステンションはイベントプロパティの長期保存に依存しており、タイムスタンプ付きのプロパティ保存制限はありません。過去2年間に追跡されたイベントプロパティを振り返ることができます。

{% alert note %}
セグメントエクステンション内でイベントプロパティを使用しても、データポイント使用量には影響しません。
{% endalert %}

### エクステンションの再生成

このエクステンションで特定の時点の1つのスナップショットを表すかどうか、またはこのエクステンションを毎日再生成するかどうかを指定できます。エクステンションは常に最初の保存後に処理を開始します。エクステンションを毎日再生成する場合は、[**エクステンションを毎日再生成**] チェックボックスを選択すると、会社のタイムゾーンで毎日午前0時頃に再生成の処理が開始されます。

{% alert important %}
エクステンションを毎日再生成する設定は、未使用のセグメントエクステンションに対して自動的にオフになります。Braze では、未使用のエクステンションを次の基準を満たすものと定義しています。

- アクティブなキャンペーン、キャンバス、セグメントで使用されていない
- 非アクティブな (下書きの、停止された、アーカイブされた) キャンペーン、キャンバス、またはセグメントで使用されていない
- 7日以上変更されていない

この設定をオフにすると、Braze は会社の連絡先とエクステンションの作成者に通知します。エクステンションを毎日再生成するオプションはいつでも有効にできます。
{% endalert %}

## ステップ 4: セグメントエクステンションを保存する

[**保存**] をクリックすると、エクステンションの処理が開始されます。エクステンションの生成にかかる時間は、ユーザーの数、キャプチャするカスタムイベントまたは購入イベントの数、履歴を振り返る日数によって異なります。

エクステンションが処理されている間、エクステンションの名前の横に小さなアニメーションが表示され、エクステンションリストの [**最終処理日**] 列に 「処理中」 という単語が表示されます。処理中はエクステンションを編集できないことに注意してください。

![][5]

## ステップ 5: エクステンションをセグメントで使用する

エクステンションを作成したら、セグメントを作成したり、キャンペーンやキャンバスのオーディエンスを定義したりする際のフィルターとして使用できます。まず、[**ユーザー属性**] セクションのフィルターリストから [**Braze セグメントエクステンション**] を選択します。

![][6]

Braze セグメントエクステンションフィルターリストから、このセグメントに含める、または除外したいエクステンションを選択します。

![][7]

エクステンション条件を表示するには、[**エクステンションの詳細を表示**] をクリックして、モーダルポップアップに詳細を表示します。

![][8]{: style="max-width:70%;"}

これで、[セグメントの作成] [11] を通常どおり進めることができます。

[2]: {% image_buster /assets/img/segment/segment_extension2.png %}
[3]: {% image_buster /assets/img/segment/segment_extension1.png %}
[5]: {% image_buster /assets/img/segment/segment_extension5.png %}
[6]: {% image_buster /assets/img/segment/segment_extension7.png %}
[7]: {% image_buster /assets/img/segment/segment_extension6.png %}
[8]: {% image_buster /assets/img/segment/segment_extension8.png %}
[10]: {{site.baseurl}}/user_guide/engagement_tools/segments/segmentation_filters/
[11]: {{site.baseurl}}/user_guide/engagement_tools/segments/creating_a_segment/
[12]: {% image_buster /assets/img/segment/property1.png %}
[13]: {% image_buster /assets/img/segment/property2.png %}
[13.5]: {% image_buster /assets/img/segment/property5.png %}
[14]: {% image_buster /assets/img/segment/property3.png %}
[15]: {% image_buster /assets/img/segment/property4.png %}
[16]: {% image_buster /assets/img/Shopify/arrow.jpeg %}
[17]: {% image_buster /assets/img/segment/segment_extension9.png %}
[18]: {% image_buster /assets/img/segment/nested_segment_extensions.png %}
[19]: {{site.baseurl}}/user_guide/engagement_tools/campaigns/building_campaigns/delivery_types/triggered_delivery/
[20]: {% image_buster /assets/img/segment/segment_extension_modal.png %}
