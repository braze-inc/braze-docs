---
nav_title: 属性トリガー
article_title: 属性トリガー
page_order: 1
alias: /attribute_triggers/
page_type: reference
description: "この参考記事では、属性トリガーの概要と、それを使ってユーザーにアクションベースのメッセージを送信する方法について説明します。"
tool:
  - Campaigns

---

# 属性トリガー

> 属性トリガーは、ユーザーの購読状態やカスタム属性値が変更されたときに、アクションベースのメッセージを送信することができます。 

属性トリガーは以下のシナリオで利用できます。

- サブスクリプションの状態を更新する。
- ブール値、整数値、文字列、または日付のカスタム属性値を、任意の値に変更する。
- ブール値、整数値、文字列のカスタム属性値を特定の値に変更する。

属性トリガーの使用を開始するには、キャンペーンまたはキャンバスコンポーネントを作成し、配信方法として**アクションベースの配信**を選択します。次に、使用したい属性トリガーを選択します。

![]({% image_buster /assets/img_archive/trigger_attribute.png %})

### サブスクリプションのステータスを更新する

`Update Subscription Status` トリガーを使うと、購読ステータスが更新されたユーザーをターゲットにすることができます。 

たとえば、メールやプッシュ配信のステータスがオプトインに変わったユーザーをターゲットにし、オプトインしてくれたことに感謝することができます。また、ユーザーがメール配信を停止するたびに、Webhook をシステムに送信し、社内システムが最新の購読ステータス情報を入手できるようにすることもできます。

{% alert important %}
デフォルトのメールグローバル状態 `subscribed` を持つ新規ユーザーが作成され、その後に状態を `subscribed` に更新するリクエストがあった場合、購読ステータスは変化していないため、このトリガーは適用されません。
{% endalert %}

### サブスクリプショングループのステータスを更新する

`Update Subscription Group Status` トリガーを使うと、メール、SMS、WhatsApp の購読グループステータスが更新されたユーザーをターゲットにすることができます。 

たとえば、ユーザーがプログラムにオプトインしたときに、歓迎の SMS メッセージを送ることができます。また、アップデートソースを指定することで、メッセージを送信するタイミングをより細かくコントロールすることもできます。 

利用可能なアップデートソースはチャンネルごとに異なります。
- CSVインポート
- ユーザー設定センター
- REST API
- SDK
- Shopify（メール、SMS）
- インバウンドメッセージ（SMS）

たとえば、Braze はすでに特定のインバウンド SMS に自動的に応答しているため、インバウンドメッセージ全般ではなく、REST API から更新が来た場合にのみ、歓迎の SMS メッセージを送信したい場合があります。

### カスタム属性値を変更する

変更属性については、まずトリガーが評価され、次にオーディエンス基準が評価されます。これは、オーディエンスの基準が最初に評価され、次にトリガーされるというデフォルトの動作とは異なります。競合状態を回避するには、トリガーとして使用される属性が、オーディエンスの絞り込みに使用される属性と同じでないことを確認します。

#### 新しい値オプション

`any new value` オプションとあわせて `Change Custom Attribute Value` トリガーを使用すると、ブーリアン値、整数値、文字列値、または日付値が新しい値に変更されたユーザーをターゲットにすることができます。

たとえば、ロイヤルティポイント数が変化したユーザーをターゲットにすると、現在のポイント数を知らせることができます。例として、ユーザーが 85 ロイヤルティポイントを持っており、ロイヤルティポイント属性が新しい値に変わったときにトリガーするキャンペーンを設定した場合、このユーザーのロイヤルティポイント属性値が新しい値（e.g 83、84、86など）に変更された場合、キャンペーンがトリガーされます。

次に、階層更新通知のユースケースの例を見てみましょう。ロイヤルティ層が変わったら、ユーザーにアラートを出したいことがあります。このユースケースを達成するには、`Change Custom Attribute Value` をトリガーとするキャンペーンを設定し、カスタム属性のロイヤリティ層が新しい値に変更されたときにトリガーされるように設定します。

{% alert important %}
属性トリガーは現在、配列属性では使用できません。
{% endalert %}

![任意の新しい値]({% image_buster /assets/img_archive/any_value.png %})

また、Liquid を使用して、顧客の新しいロイヤルティ層によりメッセージ本文をパーソナライズし、変更に関する詳細情報を顧客に提供することもできます。

{% raw %}
```liquid
Your loyalty tier was just changed to {{custom_attribute.${loyalty_tier}}}
```
{% endraw %}

#### 具体的な値

`specific value` オプションとあわせて`Change Custom Attribute Value` トリガーを使用すると、ブーリアン、整数、文字列のカスタム属性が特定の値に変わったときにユーザーをターゲットにすることができます。 

たとえば、ロイヤルティ層が最上位層に変わったユーザーをターゲットにすることができます。例として、最上位のロイヤルティ層はスーパー VIP であるとします。ユーザーのロイヤルティ層のカスタム属性が `Super VIP` に変わったときにトリガーされるようにキャンペーンを設定することで、スーパー VIP になったユーザーを祝福することができます。

![]({% image_buster /assets/img_archive/super_vip.png %})

{% alert important %}
- 配列および日付カスタム属性には、特定のカスタム属性値の属性トリガーは使用できません。
- カスタム属性値変更トリガーは、カスタム属性値がnullに更新されたときにトリガーされません。  
- カスタム属性の値変更トリガーは、カスタム属性の値が変更されたときにのみトリガーされます。カスタム属性の現在の値がBrazeに再送信された場合（e.gお気に入りの色属性の値が赤で、その値をBrazeに再送信する場合）、カスタム属性値の変更トリガーは発生しません。
- カスタム属性値の変更トリガーは、新しく作成されたユーザーにも適用されます。
{% endalert %}

