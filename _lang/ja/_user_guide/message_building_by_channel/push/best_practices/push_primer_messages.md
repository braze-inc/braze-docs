---
nav_title: アプリ内メッセージのプッシュプライマー
article_title: プッシュ・プライマー アプリ内メッセージ
page_order: 1
page_type: reference
description: "この記事では、プッシュ・プライマー・アプリ内メッセージの前提条件と設定方法について説明する。"
channel: push

---

# アプリ内メッセージのプッシュプライマー

![ストリーミングアプリのプライマーアプリ内メッセージを押します。この通知は、「Movie Cannon からプッシュ通知を受け取りますか? 通知には新作映画やテレビ番組、その他のお知らせが含まれることがあり、いつでもオフにすることができます」というものです。]({% image_buster /assets/img_archive/push_primer_iam.png %}){: style="float:right;max-width:40%;margin-left:15px;border:none;"}

> ユーザーにプッシュ許可を求めるチャンスは一度しかないため、プッシュ登録を最適化することは、プッシュメッセージのリーチを最大化するために極めて重要である。これを実現するには、アプリ内メッセージを使って、ユーザーがオプトインを選択した場合、どのようなメッセージを受け取ることが期待できるかを、ネイティブのプッシュプロンプトを表示する前に説明すればよい。これはプッシュ・プライマーと呼ばれる。

Braze でプッシュプライマーのアプリ内メッセージを作成するには、iOS、Android、または Web のアプリ内メッセージを作成するときに、ボタンのクリック時動作「プッシュ通知の権限を要求」を使用できます。

## 前提条件

この機能には[ボタンのクリック時動作](#button-actions)が必要です。これは、以下の最小バージョン以降でサポートされています。

{% sdk_min_versions swift:5.4.0 android:21.0.0 web:4.0.3 %}

さらに、以下で説明するプラットフォーム固有の詳細に注意してください。

{% tabs local %}
{% tab android %}
|OS バージョン|追加情報|
\|----------|----------------------|
| **Android 12 以前** | プッシュプライマーの実装は推奨されません。プッシュはデフォルトでオプトインされているためです。|
| **Android 13+** | ユーザーがプッシュアクセス許可プロンプトを2回拒否した場合、Android は Braze プッシュプライマーメッセージを含むそれ以降のプロンプトをブロックします。この後に権限を付与するには、ユーザーはデバイス設定でアプリのプッシュを手動で有効にする必要があります。|
{: .reset-td-br-1 .reset-td-br-2 role="presentation"}
{% endtab %}

{% tab swift %}
### 一般情報

- プッシュプロンプトは、オペレーティングシステムによって強制されるインストールごとに1 回のみ表示できます。
- アプリのプッシュ設定が明示的にオンまたはオフの場合、プロンプトは表示されません。プロンプトは[暫定承認](https://developer.apple.com/documentation/usernotifications/asking_permission_to_use_notifications#3544375)を得たユーザーにのみ表示されます。
  - **アプリのプッシュ設定がオンになっている:**ユーザが既にオプトインしているため、Braze はアプリ内メッセージを表示しません。
  - **アプリのプッシュ設定がオフ:**ユーザーをデバイス設定内のアプリのプッシュ通知設定にリダイレクトする必要があります。

### 手動でコードを除去する

このチュートリアルを使って設定したアプリ内メッセージは、ユーザーがアプリ内メッセージボタンをクリックすると、ネイティブのプッシュ・プロンプト・コードを自動的に呼び出す。プッシュ通知の許可を 2 回要求したり、間違った時間に要求したりしないようにするには、開発者は、実装されている既存のプッシュ通知統合を変更して、アプリ内メッセージがユーザーに表示される最初のプッシュ通知プライマーであることを確認する必要があります。

開発チームは、アプリまたはサイトのプッシュ通知の実装を確認し、プッシュ許可を要求するコードを手動で削除する必要があります。例えば、以下のコードへの参照を削除します。

{% subtabs %}
{% subtab OBJECTIVE-C %}
```objc
requestAuthorizationWithOptions
```
{% endsubtab %}
{% subtab swift %}
```swift
requestAuthorization
```
{% endsubtab %}
{% subtab JavaScript %}
```javascript
braze.requestPushPermission()
// or
appboy.registerAppboyPushMessages()
```
{% endsubtab %}
{% subtab Java %}
```java
android.permission.POST_NOTIFICATIONS
```
{% endsubtab %}
{% endsubtabs %}
{% endtab %}
{% endtabs %}

## ステップ 1:アプリ内メッセージを作成する

まず、[アプリ内メッセージ]({{site.baseurl}}/user_guide/message_building_by_channel/in-app_messages/create/)を作成し、メッセージタイプとレイアウトを選択します。

メッセージとボタンの両方に十分なスペースを確保するには、フルスクリーンまたはモーダルメッセージレイアウトを使用します。全画面を選択した場合は、画像が必要であることに注意してください。

## ステップ 2: メッセージを構築する

さて、いよいよコピーを加える番だ！ここで、プッシュプライマーは、プッシュ通知をオンにするようにユーザーをプライミングする必要があることに注意してください。メッセージ本文では、ユーザーがプッシュ通知をオンにすべき理由を強調することをお勧めする。どのような種類の通知を送りたいのか、どのような価値を提供できるのか、具体的に説明すること。

例えば、あるニュースアプリは次のようなプッシュ・プライマーを使うかもしれない：

```plaintext
Breaking news on the go! Enable push notifications to get alerts for major stories and topics that matter to you.
```

ストリーミングアプリでは、次が使用される場合があります。

```plaintext
Get push notifications from Movie Cannon? Notifications may include new movies, TV shows, or other notices and can be turned off at any time.
```

ベストプラクティスおよびその他のリソースについては、[カスタムオプトインプロンプトの作成]({{site.baseurl}}/user_guide/message_building_by_channel/push/best_practices/push_primer_messages/)を参照してください。

## ステップ 3: ボタン動作を指定する {#button-actions}

アプリ内メッセージにボタンを追加するには、2 つの**Button** ブロックをメッセージにドラッグします。メッセージはアプリ内メッセージのプライマリボタンとセカンダリボタンとして機能します。また、メッセージに行をドラッグし、ボタンを行にドラッグして、ボタンが同じ水平の行にあるようにすることもできます(上下に重なっているのとは対照的です)。ボタンテキストには「通知を許可する」と「今は許可しない」をお勧めしますが、割り当てることのできるボタンプロンプトはたくさんあります。

ボタンコピーを追加したら、各ボタンのクリック時の動作を指定する：

- **ボタン 1:**これを「メッセージを閉じる」に設定します。これはセカンダリーボタンで「今は許可しない」オプションです。
- **ボタン 2: **これを「プッシュ通知の権限を要求」に設定します。これはプライマリボタンで「通知を許可する」オプションです。

![2 つのボタンがあるIn-アプリ メッセージ作成画面:"Allow 通知 s"および"Not now"。]({% image_buster /assets/img_archive/push_primer_button_behavior.png %})

## ステップ 4: 配信のスケジュール

プッシュプライマーを適切な時間に送信するように設定するには、アプリ内メッセージをアクションベースのメッセージとしてスケジュールし、トリガーアクションとして**カスタムイベントを実行する**必要がある。

理想的なタイミングはさまざまだが、Brazeは、ユーザーが何らかの[価値の高いアクションを](https://www.braze.com/resources/videos/mapping-high-value-actions)完了するまで待つことを提案している。これは、ユーザーがアプリやサイトに価値を見出し始めていることを示すか、プッシュ通知で対応できる切実なニーズがある場合だ（例えば、ユーザーが注文をした後で、配送追跡情報を提供したい場合など）。こうすることで、プロンプトはあなたのブランドにとってだけでなく、顧客にとっても有益なものとなる。

![アクションベースの配信設定 s は、&quot のカスタムイベントを実行したユーザーs に送信します。Watch List&quot に追加します。;。]({% image_buster /assets/img_archive/push_primer_trigger.png %})

## ステップ 5: ユーザーのターゲット設定

プッシュプライマーキャンペーンの目的は、まだプッシュ許可を付与していないすべての機器に対してユーザーにプロンプトを出すことです。これには、初めてのユーザーや、新しい機器を入手したり、アプリライセンスを再インストールしたりする既存のユーザーが含まれます。プッシュプライマーキャンペーンを正しく対象にするには、`Foreground Push Enabled For App is false` のフィルターを追加します。このフィルターは、フォアグラウンドプッシュ通知s にまだ選択されていない個々のアプリ インストレーションを識別します。

{% alert important %}
`Push Subscription Status is not Opted In` のようなユーザーレベルのフィルターを使用すると、別のデバイスですでにオプトインされているユーザーが除外され、新しいデバイスでプロンプトが表示されなくなります。
{% endalert %}

そのうえで、どのような追加セグメントが最も適切だと感じるかを決めることができます。例えば、2回目の購入を完了したユーザー、会員になるためにアカウントを作成したばかりのユーザー、あるいは週に2回以上アプリを訪れるユーザーなどをターゲットにすることができる。これらの重要なセグメントでユーザーをターゲティングすることで、ユーザーがオプトインし、プッシュを有効にする可能性が高くなります。

## ステップ 6:コンバージョンイベント

Brazeは、コンバージョンのデフォルト設定を提案しているが、プッシュ・プライマーを取り巻く[コンバージョンイベントを]({{site.baseurl}}/user_guide/engagement_tools/messaging_fundamentals/conversion_events/)設定したい場合もあるだろう。

