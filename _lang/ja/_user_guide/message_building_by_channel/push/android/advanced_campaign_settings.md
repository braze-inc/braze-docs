---
nav_title: "プッシュキャンペーンの詳細設定"
article_title: プッシュキャンペーンの詳細設定
page_order: 5
page_layout: reference
description: "この記事では、優先度、カスタム URL、配信オプションなど、プッシュキャンペーンの詳細設定について説明します。"
platform: Android
channel:
  - push
tool:
  - Campaigns

---

# 高度なプッシュ・キャンペーン設定

> Brazeダッシュボードから送信されるAndroidとFire OSのプッシュ通知には、多くの高度な設定が用意されている。この記事では、これらの機能とそれらを効果的に使用する方法について説明します。

## 通知 ID {#notification-id}

通知IDは、あなたが選んだメッセージ・カテゴリーの一意な識別子で、そのIDからの最新のメッセージだけを尊重するようにメッセージング・サービスに通知する。通知 ID を設定すると、古くて無関係なメッセージのスタックではなく、最新で関連性の高いメッセージだけを送信できます。

通知IDを割り当てるには、IDを追加したいプッシュの構成ページに移動し、**「設定」**タブを選択する。**Notification ID**セクションに整数を入力する。通知を発行した後にこの通知を更新するには、以前に使用したのと同じIDで別の通知を送信する。

![]({% image_buster /assets/img_archive/notification_ids.png %}){: style="max-width:80%;" }

## 有効時間 (TTL) {#ttl}

time-to-live (TTL)フィールドでは、プッシュ・メッセージング・サービスでメッセージを保存する時間の長さをカスタムで設定できる。有効期限のデフォルト値は、Firebase Cloud Messaging (FCM) では 4 週間、Amazon Device Messaging (ADM) では 31 日間です。

例えば、貴社のアプリがゲームで、ユーザーが毎日ゲームをプレイし続けることを条件にゲーム内通貨ボーナスを提供するとします。一定の日数を超えたユーザーには、その連続日数が破られる危険性があることを警告するプッシュを送信できます。しかし、ユーザーが4週間後、生存期間をデフォルトに設定した状態でゲームアプリにデバイスを再接続した場合、それらのメッセージはメッセージングサービス内ですでに期限切れとなり、配信されないことになる。

## Firebase メッセージング配信の優先順位 {#fcm-priority}

**Firebase Messaging Delivery Priority** フィールドでは、「通常」または「高」のどちらの優先度でプッシュを Firebase Cloud Messaging に送信するかを制御できます。詳細については、[FCM のドキュメント](https://firebase.google.com/docs/cloud-messaging/concept-options#setting-the-priority-of-a-message)を参照してください。

## 要約テキスト

要約テキストでは、**拡張通知**ビューに追加のテキストを設定できる。要約テキストは、展開されたビューのメッセージ本文の下に表示されます。画像付きの通知のキャプションとしても機能します。

![][9]

画像を含むプッシュ通知の場合、折りたたまれたビューにはメッセージテキストが表示され、通知が展開されると、要約テキストが画像のキャプションとして表示されます。この動作の例として、以下のアニメーションをご覧いただきたい。

![要約 テキスト 行動][15]

## カスタムURI

**カスタム URI** 機能を使用すると、通知がクリックされたときの誘導先 Web URL または Android リソースを指定できます。カスタム URI が指定されていない場合、通知をクリックするとユーザーはアプリに誘導されます。カスタム URI を使用してアプリ内でディープリンクしたり、アプリ外部のリソースにユーザーを誘導することができます。これは、[メッセージング API][13] またはプッシュコンポーザーの [**設定**] で指定できます。

![カスタムURI][12]

## 通知の表示優先度

{% alert important %}
通知の表示優先度設定は、Android O 以降を実行しているデバイスでは使用されなくなりました。新しいデバイスの場合は、[通知チャネル設定](https://developer.android.com/training/notify-user/channels#importance)を使用して優先度を設定します。
{% endalert %}

プッシュ通知の優先度レベルは、通知トレイ内で他の通知と比較して通知がどのように表示されるかに影響します。また、通常のメッセージや優先度の低いメッセージは、バッテリー寿命を延ばすために遅延がわずかに長くなったり、バッチ処理で送信されたりするのに対し、優先度の高いメッセージは常に即座に送信されるため、配信の速度と方法にも影響する可能性があります。

この機能は、メッセージの重要度や一刻を争うかどうかに基づいてメッセージを区別するのに便利だ。例えば、危険な道路状況についての通知は高い優先度を付ける候補となり、実施中のセールについての通知は低い優先度を付けるべきです。送信する通知に邪魔になる優先度を実際に使用する必要があるかどうかをよく検討してください。常にユーザーの受信トレイのトップを占有したり、他のアクティビティを中断したりすると、マイナスの影響を与える可能性があります。

Android O では、通知の優先度が通知チャネルのプロパティになりました。開発者と協力して設定中にチャネルの優先度を定義し、ダッシュボードを使用して通知音を送信するときに適切なチャネルを選択する必要があります。Android O より前のバージョンを実行しているデバイスでは、Braze ダッシュボードとメッセージング API を介して、Android と Fire OS 通知の優先レベルを指定することができます。

特定の優先度を指定したメッセージをユーザー群全体に送信するには、[通知チャネル設定][17] (O 以降のデバイスを対象とする) を通じて間接的に優先度を指定し、ダッシュボードから個別の優先度を送信する (O より前のデバイスを対象とする) ことをお勧めします。

AndroidまたはFire OSのプッシュ通知で設定できる優先度については、以下の表を参照のこと：

| 優先順位 | 説明| `priority` 値 （APIメッセージ用） |
|------|-----------|----------------------------|
| マックス | 緊急または一刻を争うメッセージ。 | `2` |
| 高 | 友人からの新着メッセージなど、重要な連絡。 | `1` |
| デフォルト | ほとんどの通知。メッセージが他の優先度タイプのどれにも明確に該当しない場合に使用する。 | `0` |
| 低 | ユーザーに知ってもらいたいが、すぐに行動を起こす必要のない情報。 | `-1`|
| 最小 | コンテキストまたは背景情報 | `-2`|
{: .reset-td-br-1 .reset-td-br-2 .reset-td-br-3 role="presentation" }

詳細については、Google の [Android 通知][2]ドキュメントを参照してください。

## プッシュ・カテゴリー

アンドロイドのプッシュ通知では、通知があらかじめ定義されたカテゴリーに入るかどうかを指定するオプションがある。AndroidシステムUIは、このカテゴリーを使用して、ユーザーの通知トレイのどこに通知を配置するかについて、ランキングやフィルタリングの決定を行うことができる。

![「カテゴリー」が「なし」に設定されている [設定] タブ (デフォルト設定)。][52]

| カテゴリー | 説明 |
|---|-------|
| なし | デフォルトのオプション。 |
| アラーム | アラームまたはタイマー。 |
| 電話 | 着信通話 （音声または動画） または同様の同期通信リクエスト。 |
| メール | 非同期バルクメッセージ（電子メール）。 |
| エラー | バックグラウンド操作または認証ステータスでエラーが発生した。 |
| イベント | カレンダーのイベント。 |
| メッセージ | 着信ダイレクトメッセージ （SMS、インスタントメッセージなど）。 |
| 進捗状況 | バックグラウンドで長時間実行される操作の進行状況。 |
| プロモーション | プロモーションまたは広告。 |
| レコメンデーション | 具体的でタイムリーな、ひとつのことを勧める。 |
| リマインダー | ユーザーがスケジュールしたリマインダー。 |
| サービス | バックグラウンドサービスを実行していることを示す。 |
| ソーシャル | ソーシャルネットワークまたは共有の更新。 |
| ステータス | デバイスやコンテキストのステータスに関する継続的な情報。 |
| システム | システムまたはデバイスのステータスが更新される。システム用に予約済み。 |
| 輸送 | 再生用のメディアトランスポートコントロール。 |
{: .reset-td-br-1 .reset-td-br-2 role="presentation" }

## プッシュの視認性

アンドロイドのプッシュ通知には、ユーザーのロック画面にどのように通知が表示されるかを決めるオプション・フィールドがある。視認性のオプションと説明については、以下の表を参照のこと。

| 視認性 | 説明 |
|---|-----|
| パブリック | ロック画面に通知が表示される |
| プライベート | コンテンツは非表示です」というメッセージで通知が表示される |
| シークレット | ロック画面に通知が表示されない |
{: .reset-td-br-1 .reset-td-br-2 role="presentation" }

さらに、Androidユーザーは、端末の通知プライバシー設定を変更することで、プッシュ通知をロック画面に表示する方法を上書きすることができる。この設定は、プッシュ通知からの可視性を上書きする。

![視認性の設定が有効で、プライベートに設定されたダッシュボードのプッシュ優先度。][53]{: style="float:right;max-width:60%;margin-left:15px;"}

デバイスの通知プライバシー設定が「**すべてのコンテンツを表示**」（デフォルト設定）であれば、可視性にかかわらず、すべての通知がユーザーのロック画面に表示される。同様に、通知のプライバシーが「**通知を表示しない**」に設定されている場合、通知はロック画面に表示されない。可視性は、通知プライバシーが「**機密コンテンツを隠す**」に設定されている場合にのみ効果がある。

Android Lollipop 5.0.0より前の端末では、この可視化は影響しない。つまり、これらの端末ではすべての通知が表示される。

詳しくは[Androidドキュメント][51] ]を参照のこと。

## 通知音

Android O では、通知音は通知チャネルのプロパティになりました。開発者と協力して設定時にチャネルのサウンドを定義し、通知を送信するときにダッシュボードを使用して適切なチャネルを選択する必要があります。

Android Oより前のバージョンのAndroidを搭載したデバイスでは、Brazeはダッシュボードのコンポーザーから個々のプッシュメッセージのサウンドを設定できる。これを行うには、デバイスのローカルサウンドリソースを指定します (例: `android.resource://com.mycompany.myapp/raw/mysound`)。 

このフィールドで [**デフォルト**] を選択すると、デバイスのデフォルトの通知音が再生されます。これは、[メッセージング API][13] またはプッシュコンポーザーの [**設定**] で指定できます。

![][11]

次に、ダッシュボードのプロンプトに完全なサウンドリソース URI （例えば `android.resource://com.mycompany.myapp/raw/mysound`） を入力します。

特定のサウンドでメッセージをユーザー群全体に送信するには、[通知チャネル設定][16] (O 以降のデバイスを対象とする) を通じて間接的にサウンドを指定し、ダッシュボードから個別のサウンドを送信する (O より前のデバイスを対象とする) ことをお勧めします。

[2]: http://developer.android.com/design/patterns/notifications.html
[9]: {% image_buster /assets/img_archive/summary_text.png %}
[11]: {% image_buster /assets/img_archive/sound_android.png %}
[12]: {% image_buster /assets/img_archive/deep_link.png %}
[13]: {{site.baseurl}}/api/endpoints/messaging/
[15]: {% image_buster /assets/img_archive/messagesummary.gif %}
[17]: https://developer.android.com/training/notify-user/channels#importance
[16]: https://developer.android.com/training/notify-user/channels
[51]: https://developer.android.com/guide/topics/ui/notifiers/notifications
[52]: {% image_buster /assets/img_archive/braze_category.png %}
[53]: {% image_buster /assets/img_archive/braze_visibility.png %}
