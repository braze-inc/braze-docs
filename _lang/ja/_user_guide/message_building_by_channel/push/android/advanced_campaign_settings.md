---
nav_title: "プッシュキャンペーンの詳細設定"
article_title: プッシュキャンペーンの詳細設定
page_order: 5
page_layout: reference
description: "この記事では、優先度、カスタム URL、配信オプションなど、プッシュキャンペーンの詳細設定について説明します。"
platform: Android
channel:
  - push
tool:
  - Campaigns

---

# 高度なプッシュ・キャンペーン設定

> Brazeダッシュボードから送信されるAndroidとFire OSのプッシュ通知には、多くの高度な設定が用意されている。この記事では、これらの機能とそれらを効果的に使用する方法について説明します。

## 通知 ID {#notification-id}

通知IDは、あなたが選んだメッセージ・カテゴリーの一意な識別子で、そのIDからの最新のメッセージだけを尊重するようにメッセージング・サービスに通知する。通知 ID を設定すると、古くて無関係なメッセージのスタックではなく、最新で関連性の高いメッセージだけを送信できます。

通知IDを割り当てるには、IDを追加したいプッシュの構成ページに移動し、**「設定」**タブを選択する。**Notification ID**セクションに整数を入力する。通知を発行した後にこの通知を更新するには、以前に使用したのと同じIDで別の通知を送信する。

![通知IDフィールド。]({% image_buster /assets/img_archive/notification_ids.png %}){: style="max-width:60%;" }

## 有効時間 (TTL) {#ttl}

**Time to Live** フィールドでは、プッシュ・メッセージング・サービスでメッセージを保存する時間の長さをカスタムで設定できる。デバイスが TTL を過ぎてもオフラインのままである場合、メッセージは期限切れになり、配信されません。

Android プッシュの有効時間を編集するには、作成画面に移動し、[**設定**] タブを選択します。**Time to Live**フィールドを見つけ、日、時間、または秒単位で値を入力します。

有効時間のデフォルト値は、[[プッシュ設定]({{site.baseurl}}/user_guide/administrative/app_settings/push_settings/)] ページで管理者が定義します。デフォルトでは、Braze はプッシュ TTL を各プッシュメッセージングサービスの最大値に設定します。デフォルトの TTL 設定はグローバルに適用されますが、キャンペーンの作成時にメッセージレベルで上書きできます。これは、異なるキャンペーンで必要な緊急性や配信期間が異なる場合に役立ちます。

たとえば、アプリが毎週トリビアコンテストを開催しているとします。開始する1時間前にプッシュ通知を送信します。TTL を1時間に設定することで、コンテスト開始後にアプリを開くユーザーが、すでに開始されているイベントに関する通知を受け取らないようにします。

{% details ベストプラクティス %}

#### 短い TTL を使用する場合

TTL を短くすることで、ユーザーは関連性をすぐに失うイベントやプロモーションの通知をタイムリーに受け取ることができます。以下に例を示します。

- **小売**2時間後に終了するフラッシュセールのプッシュを送信する (TTL:1～2時間)
- **配食:**ユーザーの注文が近くにあるときに通知する (TTL:10～15分)
- **交通アプリ:**乗車到着の更新情報を共有 (TTL: 数分)
- **イベント通知:**ウェビナーがまもなく開始されるときにユーザーに通知する (TTL: 1 時間未満)

#### TTL が短くならないようにする場合

- キャンペーンのメッセージが数日または数週間にわたって関連性を持つ場合 (サブスクリプションの更新のリマインダーや継続的なプロモーションなど)。
- アプリの更新通知や機能のプロモーションなど、緊急性よりもリーチの最大化が重要な場合。

{% enddetails %}

## Firebase メッセージング配信の優先順位 {#fcm-priority}

**Firebase Messaging Delivery Priority** フィールドでは、「通常」または「高」のどちらの優先度でプッシュを Firebase Cloud Messaging に送信するかを制御できます。この設定は、メッセージの配信速度とデバイスのバッテリー寿命に及ぼす影響を決定します。

| 優先順位 | 説明 | 最適な用途 |
|---------|-------------|----------|
| 通常 | バッテリー節約のために遅延する可能性があるバッテリー最適化配信 | 緊急でないコンテンツ、プロモーション・オファー、ニュースの更新 |
| 高 | バッテリー消費量が高い即時配信 | 時間依存の通知、重要なアラート、ライブイベントの更新、アカウントアラート、ニュースの更新、緊急のリマインダー |
{: .reset-td-br-1 .reset-td-br-2 .reset-td-br-3 role="presentation" }

#### 考慮事項

- **デフォルト設定**:[プッシュ設定]({{site.baseurl}}/user_guide/administrative/app_settings/push_settings/)で、すべてのAndroidキャンペーンのデフォルトのFCM優先度を設定できます。このキャンペーンレベルの設定は、必要に応じてデフォルトを上書きします。
- **優先度の格下げ**:ユーザーに表示される通知やユーザーの関与が発生しない優先度の高いメッセージがアプリから頻繁に送信されることをFCMが検出した場合、それらのメッセージは自動的に通常の優先度に廃止される可能性があります。
- **バッテリーへの影響**:優先度の高いメッセージは、スリープ状態のデバイスをより頻繁に起動するため、バッテリー消費量が増えます。この優先度は慎重に使用してください。

メッセージの処理と削除の詳細については、[FCM のドキュメント](https://firebase.google.com/docs/cloud-messaging/concept-options#setting-the-priority-of-a-message) および[Android](https://firebase.google.com/docs/cloud-messaging/android/message-priority#deprioritize) でのメッセージの処理と削除を参照してください。

## 要約テキスト

要約テキストを使用すると、拡張通知ビューに追加のテキストを設定できます。画像付きの通知のキャプションとしても機能します。

![タイトルが「This is the title for the notification.」、要約テキストが「This is the summary text for the notification.」の Android メッセージ。]({% image_buster /assets/img/android/push/collapsed-android-notification.png %}){: style="max-width:65%;"}

要約テキストは、展開されたビューのメッセージ本文の下に表示されます。 

![タイトルが「This is the title for the notification.」、要約テキストが「This is the summary text for the notification.」の Android メッセージ。]({% image_buster /assets/img/android/push/expanded-android-notification.png %}){: style="max-width:65%;"}

画像を含むプッシュ通知の場合、折りたたまれたビューにはメッセージテキストが表示され、通知が展開されると、要約テキストが画像のキャプションとして表示されます。 

## カスタムURI

**カスタム URI** 機能を使用すると、通知がクリックされたときの誘導先 Web URL または Android リソースを指定できます。カスタム URI が指定されていない場合、通知をクリックするとユーザーはアプリに誘導されます。カスタム URI を使用してアプリ内でディープリンクしたり、アプリ外部のリソースにユーザーを誘導することができます。これは、[メッセージング API]({{site.baseurl}}/api/endpoints/messaging/) またはプッシュ作成画面の [**作成**] タブで指定できます。

![カスタムURI フィールド。]({% image_buster /assets/img_archive/deep_link.png %}){: style="max-width:60%;"}

## 通知の表示優先度

{% alert important %}
通知の表示優先度設定は、Android O 以降を実行しているデバイスでは使用されなくなりました。新しいデバイスの場合は、[通知チャネル設定](https://developer.android.com/training/notify-user/channels#importance)を使用して優先度を設定します。
{% endalert %}

プッシュ通知の優先度レベルは、通知トレイ内で他の通知と比較して通知がどのように表示されるかに影響します。また、通常のメッセージや優先度の低いメッセージは、バッテリー寿命を延ばすために遅延がわずかに長くなったり、バッチ処理で送信されたりするのに対し、優先度の高いメッセージは常に即座に送信されるため、配信の速度と方法にも影響する可能性があります。

この機能は、メッセージの重要度や一刻を争うかどうかに基づいてメッセージを区別するのに便利だ。例えば、危険な道路状況についての通知は高い優先度を付ける候補となり、実施中のセールについての通知は低い優先度を付けるべきです。送信する通知に邪魔になる優先度を実際に使用する必要があるかどうかをよく検討してください。常にユーザーの受信トレイのトップを占有したり、他のアクティビティを中断したりすると、マイナスの影響を与える可能性があります。

Android O では、通知の優先度が通知チャネルのプロパティになりました。開発者と協力して設定中にチャネルの優先度を定義し、ダッシュボードを使用して通知音を送信するときに適切なチャネルを選択する必要があります。Android O より前のバージョンを実行しているデバイスでは、Braze ダッシュボードとメッセージング API を介して、Android と Fire OS 通知の優先レベルを指定することができます。

特定の優先度でユーザーベース全体にメッセージを送信するには、[通知チャネル設定](https://developer.android.com/training/notify-user/channels#importance) (ターゲットO+ デバイスへ) で間接的に優先度を指定し、ダッシュボード(ターゲット<O デバイスへ) から個々の優先度を送信することをお勧めします。

AndroidまたはFire OSのプッシュ通知で設定できる優先度については、以下の表を参照のこと：

| 優先順位 | 説明| `priority` 値 （APIメッセージ用） |
|------|-----------|----------------------------|
| マックス | 緊急または一刻を争うメッセージ。 | `2` |
| 高 | 友人からの新着メッセージなど、重要な連絡。 | `1` |
| デフォルト | ほとんどの通知。メッセージが他の優先度タイプのどれにも明確に該当しない場合に使用する。 | `0` |
| 低 | ユーザーに知ってもらいたいが、すぐに行動を起こす必要のない情報。 | `-1`|
| 最小 | コンテキストまたは背景情報 | `-2`|
{: .reset-td-br-1 .reset-td-br-2 .reset-td-br-3 role="presentation" }

詳細については、Google の [Android 通知](http://developer.android.com/design/patterns/notifications.html)ドキュメントを参照してください。

## プッシュ・カテゴリー

アンドロイドのプッシュ通知では、通知があらかじめ定義されたカテゴリーに入るかどうかを指定するオプションがある。AndroidシステムUIは、このカテゴリーを使用して、ユーザーの通知トレイのどこに通知を配置するかについて、ランキングやフィルタリングの決定を行うことができる。

![Category(カテゴリ)が None(なし)に設定された設定タブ。デフォルト設定です。]({% image_buster /assets/img_archive/braze_category.png %}){: style="max-width:60%;"}

| カテゴリー | 説明 |
|---|-------|
| なし | デフォルトのオプション。 |
| アラーム | アラームまたはタイマー。 |
| 電話 | 着信通話 （音声または動画） または同様の同期通信リクエスト。 |
| メール | 非同期バルクメッセージ（電子メール）。 |
| エラー | バックグラウンド操作または認証ステータスでエラーが発生した。 |
| イベント | カレンダーのイベント。 |
| メッセージ | 着信ダイレクトメッセージ （SMS、インスタントメッセージなど）。 |
| 進捗状況 | バックグラウンドで長時間実行される操作の進行状況。 |
| プロモーション | プロモーションまたは広告。 |
| レコメンデーション | 具体的でタイムリーな、ひとつのことを勧める。 |
| リマインダー | ユーザーがスケジュールしたリマインダー。 |
| サービス | バックグラウンドサービスを実行していることを示す。 |
| ソーシャル | ソーシャルネットワークまたは共有の更新。 |
| ステータス | デバイスやコンテキストのステータスに関する継続的な情報。 |
| システム | システムまたはデバイスのステータスが更新される。システム用に予約済み。 |
| 輸送 | 再生用のメディアトランスポートコントロール。 |
{: .reset-td-br-1 .reset-td-br-2 role="presentation" }

## プッシュの視認性

アンドロイドのプッシュ通知には、ユーザーのロック画面にどのように通知が表示されるかを決めるオプション・フィールドがある。視認性のオプションと説明については、以下の表を参照のこと。

| 視認性 | 説明 |
|---|-----|
| パブリック | ロック画面に通知が表示される |
| プライベート | コンテンツは非表示です」というメッセージで通知が表示される |
| シークレット | ロック画面に通知が表示されない |
{: .reset-td-br-1 .reset-td-br-2 role="presentation" }

さらに、Androidユーザーは、端末の通知プライバシー設定を変更することで、プッシュ通知をロック画面に表示する方法を上書きすることができる。この設定は、プッシュ通知からの可視性を上書きする。

![視認性の設定が有効で、プライベートに設定されたダッシュボードのプッシュ優先度。]({% image_buster /assets/img_archive/braze_visibility.png %}){: style="float:right;max-width:50%;margin-left:15px;"}

デバイスの通知プライバシー設定が「**すべてのコンテンツを表示**」（デフォルト設定）であれば、可視性にかかわらず、すべての通知がユーザーのロック画面に表示される。同様に、通知のプライバシーが「**通知を表示しない**」に設定されている場合、通知はロック画面に表示されない。可視性は、通知プライバシーが「**機密コンテンツを隠す**」に設定されている場合にのみ効果がある。

Android Lollipop 5.0.0より前の端末では、この可視化は影響しない。つまり、これらの端末ではすべての通知が表示される。

詳細については、[Androidドキュメント](https://developer.android.com/guide/topics/ui/notifiers/notifications)を参照してください。

## 通知音

Android O では、通知音は通知チャネルのプロパティになりました。開発者と協力して設定時にチャネルのサウンドを定義し、通知を送信するときにダッシュボードを使用して適切なチャネルを選択する必要があります。

Android Oより前のバージョンのAndroidを搭載したデバイスでは、Brazeはダッシュボードのコンポーザーから個々のプッシュメッセージのサウンドを設定できる。これを行うには、デバイスのローカルサウンドリソースを指定します (例: `android.resource://com.mycompany.myapp/raw/mysound`)。 

このフィールドで [**デフォルト**] を選択すると、デバイスのデフォルトの通知音が再生されます。これは、[メッセージング API]({{site.baseurl}}/api/endpoints/messaging/) またはプッシュ作成画面の [**設定**] で指定できます。

![[サウンド] フィールド。]({% image_buster /assets/img_archive/sound_android.png %}){: style="float:right;max-width:50%;margin-left:15px;"}

次に、ダッシュボードのプロンプトに完全なサウンドリソース URI （例えば `android.resource://com.mycompany.myapp/raw/mysound`） を入力します。

特定のサウンドでフルユーザーベースにメッセージを送るには、[通知チャネル設定](https://developer.android.com/training/notify-user/channels)(ターゲットO+ デバイスへ)でサウンドを間接的に指定し、ダッシュボードから個別のサウンド(ターゲット<O デバイスへ)を送ることをお勧めします。

