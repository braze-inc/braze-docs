---
nav_title: レスポンシブをキャッシュする
article_title: コネクテッドコンテンツのレスポンスをキャッシュする
page_order: 2.5
description: "この記事では、コネクテッドコンテンツのレスポンスを同じワークスペース内の異なるキャンペーンやメッセージにまたがってキャッシュし、送信速度を最適化する方法について説明する。"
---

# コネクテッドコンテンツのレスポンスをキャッシュする

> コネクテッドコンテンツのレスポンシブは、異なるキャンペーンやメッセージ（同じワークスペース内）でキャッシュして、送信速度を最適化できる。

Brazeはコネクテッドコンテンツのレスポンスを永久にログに記録したり保存したりしない。コネクテッドコンテンツのコールレスポンスを明示的にLiquid変数として保存することを選択した場合、BrazeはLiquid変数をレンダリングしてメッセージを送信するために、インメモリ、つまり短期間で削除される一時的なストレージにのみ保存する。

キャッシングを防止するには、`:no_cache` を指定することができる。この場合、ネットワーク・トラフィックが増加する可能性がある。トラブルシューティングやシステムの健全性を監視するために、Brazeは、失敗したコネクテッドコンテンツコール（`404` や`429` など）を記録することもある。これらのログは最大30日間保存される。

## デフォルトのキャッシュ設定

キャッシュエージは最大5分（300秒）である。コネクテッドコンテンツの呼び出しに`:cache_max_age` パラメータを追加することで更新できる。例は次のとおりです。

{% raw %}
```
{{ {% connected_content [https://example.com/webservice.json] :cache_max_age 900 %}}}
```
{% endraw %}

GETリクエストはキャッシュされる。コネクテッド・コンテンツの呼び出しに:no_cacheパラメータを追加することで、これを設定することができる。

POSTリクエストはキャッシュされない。これは、コネクテッド・コンテンツの呼び出しに :cache_max_age パラメータを追加することで強制できる。最小キャッシュ時間は5分、最大キャッシュ時間は4時間である。

{% alert note %}
キャッシュ設定は保証されていない。キャッシュはエンドポイントへの呼び出しを減らすことができるので、キャッシュに過度に依存するのではなく、キャッシュ期間内にエンドポイントごとに複数の呼び出しを使用することをお勧めする。
{% endalert %}

### キャッシュサイズの制限

コネクテッド・コンテンツのレスポンス・ボディは最大1MBまで。レスポンス・ボディが1MBを超える場合は、キャッシュされない。

## キャッシュ時間 

コネクテッド・コンテンツは、GETエンドポイントから返す値を最低5分間キャッシュする。キャッシュ時間が指定されていない場合、デフォルトのキャッシュ時間は5分である。

コネクテッド・コンテンツのキャッシュ時間は、次の例に示すように、:cache_max_ageでより長く設定することができる。最小キャッシュ時間は5分、最大キャッシュ時間は4時間である。コネクテッドコンテンツデータは、Memcachedなどの揮発性キャッシュシステムを使用してインメモリでキャッシュされます。 

その結果、指定されたキャッシュ時間に関係なく、コネクテッドコンテンツのデータが指定よりも早くBrazeのメモリ内キャッシュから削除されることがある。これは、キャッシュ期間が提案であり、実際にBrazeによってデータがキャッシュされる期間を保証するものではないことを意味します。また、指定されたキャッシュ期間で予想されるよりも多くのコネクテッドコンテンツリクエストが発生する可能性があります。

### 指定秒間のキャッシュ

この例は900秒（または15分）キャッシュされます。

{% raw %}
```
{% connected_content https://example.com/webservice.json :cache_max_age 900 %}
```
{% endraw %}

### キャッシュバスティング

コネクテッドコンテンツによる、GET リクエストからの戻り値のキャッシュを防ぐには、`:no_cache` 構成を使用します。ただし、Braze 内部のホストからの応答は引き続きキャッシュされます。

{% raw %}
```js
{% connected_content https://example.com/webservice.json :no_cache %}
```
{% endraw %}

{% alert important %}
このオプションを使用する前に、指定したコネクテッドコンテンツのエンドポイントが集中的な大量のトラフィックを処理できることを確認してください。そうしないと、Brazeがすべてのメッセージについてコネクテッドコンテンツのリクエストを行うため、送信遅延の増加 (リクエストから応答までの遅延や時間間隔の増加) が発生する可能性があります。
{% endalert %}

BrazeはPOSTリクエストの結果をキャッシュしないので、POSTではバストをキャッシュする必要はない。

## 知っておくべきこと

- キャッシュは、コネクテッド・コンテンツの重複コールを減らすのに役立つ。しかし、ユーザーごとにコネクテッド・コンテンツの呼び出しが1回になるとは限らない。
- コネクテッドコンテンツのキャッシュは、URLとワークスペースに基づいて行われる。コネクテッドコンテンツの呼び出し先が同一のURLであれば、キャンペーンやキャンバス間でキャッシュすることができる。
- キャッシュはユーザーIDやキャンペーンではなく、ユニークなURLに基づいている。つまり、URLが同じであれば、キャッシュされたバージョンのコネクテッドコンテンツの呼び出しが、ワークスペース内の複数のユーザーやキャンペーンで使用される可能性がある。
