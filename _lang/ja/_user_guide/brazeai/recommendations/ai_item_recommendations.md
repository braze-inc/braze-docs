---
nav_title: AI 項目のレコメンデーション
article_title: AI 項目のレコメンデーション
page_order: 15
alias: "/ai_item_recommendations/"
description: "この記事では、カタログに掲載されているアイテムについて、AI によるアイテムのおすすめを作成する方法を説明します。"
---

# AI によるアイテムのおすすめ

> カタログに掲載されている商品について、AI によるおすすめ商品を作成する方法を学びます。

AI によるアイテム推奨を使用して、最も人気のある製品を計算したり、特定の [カタログ][カタログ] に対してカスタマイズされた AI によるおすすめを作成したりします。おすすめを作成した後、パーソナライゼーションを使用してメッセージにそれらの商品を挿入できます。

## 前提条件

始める前に、以下の作業を完了しておく必要があります。

- 以下に説明するおすすめタイプを使用するには、少なくとも1 つの [カタログ][カタログ]] が必要です。
- Braze 上に、カタログに保存されている一意の商品 ID への参照を含む購入データまたはイベントデータ (カスタムイベントまたは購入オブジェクト) があること。

{% alert tip %}
[AI でパーソナライズされたおすすめ](#recommendation-types)は、数百から数千のアイテムがあり、通常は購入またはインタラクションデータを持つユーザーが 30,000 人以上いる場合に最も効果的です。これはあくまでも目安であり、様々です。他の推奨タイプは、より少ないデータで動作できます。
{% endalert %}

## AI によるアイテムのおすすめの作成

アイテムのおすすめを作成するには:

1. [**分析**] > [**AI によるアイテムのおすすめ**] に移動します。
2. [**予測を作成**] > [**AI によるアイテムのおすすめ**] を選択します。

また、特定のカタログから直接おすすめを作成することもできます。[**カタログ**] ページからカタログを選択し、[**レコメンデーションを作成**] を選択します。

### ステップ 1: おすすめの詳細を追加する

おすすめに名前と説明 (オプション) を付けます。

![][1]

### ステップ 2: おすすめを定義する {#recommendation-type}

おすすめのタイプを選択します。すべてのおすすめタイプは、過去 6 か月間のアイテムインタラクション (購入またはカスタムイベント) データを使用します。以下で説明するインタラクションとは、購入イベントまたは[ステップ 3](#step-3-select-the-interaction-to-drive-recommendations) で選択されたカスタムイベントのいずれかを指します。

- **最も人気がある:**最も多く購入された商品など、ワークスペース内の全ユーザーが最も多く対話した最大 30 アイテムをカタログから算出します。
- **最新:**ユーザーが最も最近対話した最大 30 商品のリストを作成します。
- **AI によるパーソナライズ:**新しい種類の深層学習であるトランスフォーマーを使用して、各ユーザーが次に対話する可能性の高いアイテムのセットを予測します。可能性の高いものから低いものまで、次に可能性の高いものを 30 個まで算出します。このタイプの推奨事項では、大規模言語モデル (LLM) を使ってデータを他の Braze 顧客のデータと組み合わせることはありません。
- **トレンド:**ワークスペースから、ユーザーとのインタラクションに関して、直近で最もポジティブな勢いのあったアイテムを最大 30 個まで算出します。

{% alert tip %}
[**最新**] または [**AI によるパーソナライズ**] を使用する場合、パーソナライズされたおすすめを作成するためのデータが不十分なユーザーには、フォールバックとして 「**最も人気がある**」アイテムが表示されます。[**最も人気がある**] フォールバックを受信したユーザーの割合は、[**分析**] ページに表示されます。
{% endalert %}

#### ステップ 2a: 事前の購入やインタラクションを除外する (オプション)

ユーザーが既に購入したアイテムや、ユーザーが既に使用したアイテムを推薦しないようにするには、[**ユーザーが以前に操作したアイテムをおすすめとして表示しない**] を選択します。このオプションは、おすすめの [**タイプ**] が [**AI によるパーソナライズ**] に設定されている場合にのみ使用できます。

![][2-3]

この設定により、おすすめが最近更新された場合、ユーザーがすでに購入したアイテムやインタラクションしたアイテムがメッセージングに再利用されるのを防ぐことができます。ただし、おすすめ更新の間に購入したアイテムや、対話したアイテムが表示されることはあります。無料版のアイテムおすすめでは、更新は毎週行われます。プロバージョンの AI によるアイテムおすすめでは、更新が 24 時間ごとに行われます。

たとえば、AI によるアイテムのおすすめの Pro バージョンを使用している場合、ユーザーが何かを購入し、その後 30 分以内にマーケターメールを受信した場合、購入したばかりのアイテムが時間内にメールから除外されない可能性があります。ただし、24 時間後に送信されるメッセージには、そのアイテムは含まれません。

#### ステップ 2b: カタログを選択する

まだ入力されていない場合は、おすすめを取得する [カタログ][カタログ] を選択します。

#### ステップ 2c: セレクションを追加する (オプション)

おすすめをさらに制御したい場合は、[[セレクション]({{site.baseurl}}/user_guide/personalization_and_dynamic_content/catalogs/selections/)] を選択してカスタムフィルターを適用します。セレクションは、ブランド、サイズ、場所など、カタログ内の特定の列によって、おすすめアイテムをフィルタリングします。Liquid を含むセレクションは、おすすめで使用できません。

![][2-2]

{% alert tip %}
セレクションが見つからない場合は、まずカタログで設定されていることを確認してください。
{% endalert %}

### ステップ 3:おすすめを推進するインタラクションを選択する

このおすすめを最適化するイベントを選択します。このイベントは通常、「購入」ですが、アイテムとのインタラクションも可能です。

以下のイベントで最適化できます。

- [[購入オブジェクト]({{site.baseurl}}/api/objects_filters/purchase_object/)] のある購入イベント
- 購入を表すカスタムイベント
- 他のアイテムインタラクションを表すカスタムイベント (商品の表示、クリック、メディア再生など)

[**カスタムイベント**] を選択した場合は、リストからイベントを選択します。

![][3]

### ステップ 4:対応するプロパティ名を選択する {#property-name}

おすすめを作成するには、インタラクションイベント (購入オブジェクトまたはカスタムイベント) のどのフィールドが、カタログのアイテムの `id` フィールドと一致する一意の識別子を持っているかを Braze に伝える必要があります。よくわからない場合は[要件を確認](#requirements)してください。

このフィールドを [**プロパティ名**] に選択します。

[**プロパティ名**] フィールドに、SDK 経由で Braze に送信されるフィールドのリストがあらかじめ入力されます。十分なデータが提供されていれば、これらのプロパティはそれが正しいプロパティである確率の順にランク付けされます。カタログの `id` フィールドに対応するものを選択します。

![][4]

#### 要件 {#requirements}

プロパティを選択するには、いくつかの要件があります。

- 選択したカタログの `id` フィールドにマッピングする必要があります。
- **購入オブジェクトを選択した場合:**`product_id` またはインタラクションイベントの `properties` のフィールドである必要があります。
- **カスタムイベントを選択した場合:**カスタムイベントの `properties` のフィールドである必要があります。
- ネストされたフィールドは、ドット表記を用いて `event_property.nested_property` の形式で [**プロパティ名**] ドロップダウンに入力する必要があります。たとえば、イベントプロパティ `location` 内のネストされたプロパティ `district_name` を選択する場合は、「`location.district_name`」と入力します。
- フィールドは商品の配列の中にあってもいいし、IDの配列で終わってもいい。いずれの場合も、各製品 ID は、同じタイムスタンプを持つ個別の連続したイベントとして扱われます。

#### マッピングの例

以下のマッピング例は、どちらもこのサンプルカタログを参照しています。

<style type="text/css">
.tg td{word-break:normal;}
.tg th{word-break:normal;font-size: 14px; font-weight: bold; background-color: #f4f4f7; text-transform: lowercase; color: #212123; font-family: "Sailec W00 Bold",Arial,Helvetica,sans-serif;}
.tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top;word-break:normal}
</style>
<table class="tg">
<thead>
  <tr>
    <th class="tg-0pky">id</th>
    <th class="tg-0pky">名称</th>
    <th class="tg-0pky">価格</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0pky">ADI-BL-7</td>
    <td class="tg-0pky">アディダスブラックサイズ 7</td>
    <td class="tg-0pky">100.00 米ドル</td>
  </tr>
  <tr>
    <td class="tg-0pky">ADI-RD-8</td>
    <td class="tg-0pky">アディダスレッドサイズ 8</td>
    <td class="tg-0pky">100.00 米ドル</td>
  </tr>
  <tr>
    <td class="tg-0pky">ADI-WH-9</td>
    <td class="tg-0pky">アディダスホワイトサイズ 9</td>
    <td class="tg-0pky">100.00 米ドル</td>
  </tr>
  <tr>
    <td class="tg-0pky">ADI-PP-10</td>
    <td class="tg-0pky">アディダスパープルサイズ 10</td>
    <td class="tg-0pky">75.00 米ドル</td>
  </tr>
</tbody>
</table>

{% tabs %}
{% tab カスタムイベント %}

たとえば、カスタムイベント `added_to_cart` を使用して、顧客がチェックアウトする前に同様の商品をお勧めできるようにするとします。イベント `added_to_cart` にはイベントプロパティ `product_sku` があります。

`product_sku` プロパティには、サンプルカタログの `id` 列の値のうち少なくとも 1 つが含まれている必要があります: "ADI-BL-7"、"ADI-RD-8"、"ADI-WH-9"、または "ADI-PP-10"。すべてのカタログアイテムにイベントは必要ありませんが、レコメンデーションエンジンの処理に十分なコンテンツを提供するために、いくつかのイベントが必要です。

##### カスタムイベントオブジェクトの例

このイベントには `"product_sku": "ADI-BL-7"` があり、サンプルカタログの最初のアイテムと一致します。

```json
{
  "events": [
    {
      "external_id": "user1",
      "app_id": "your-app-id",
      "name": "added_to_cart",
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "product_sku": "ADI-BL-7"
      }
    }
  ]
}
```

##### 商品の配列を持つカスタムイベントオブジェクトの例

イベント・プロパティが複数の製品を配列に含む場合、各製品IDは個別の連続したイベントとして扱われる。このイベントは、プロパティ `products.sku` を使用して、サンプルカタログの1番目のアイテムと3番目のアイテムに一致させることができます。

```json
{
  "events": [
    {
      "external_id": "user1",
      "app_id": "your-app-id",
      "name": "added_to_cart",
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "transaction_id": "2ff3f9a9-8803-4c3a-91da-14adbf93dc99",
        "products": [
          { "sku": "ADI-BL-7" },
          { "sku": "ADI-WH-9" }
        ]
      }
    }
  ]
}
```

##### 商品ID配列を含むネストされたオブジェクトを持つカスタムイベントオブジェクトの例

商品IDがオブジェクトではなく配列の値である場合も、同じ記法を使うことができ、各商品IDは個別の連続したイベントとして扱われる。これは、次のイベントでネストされたオブジェクトと柔軟に組み合わせることができます。このためには、サンプルカタログの1番目と3番目のアイテムに一致するようにこのプロパティを `purchase.product_skus` として設定します。

```json
{
  "events": [
    {
      "external_id": "user1",
      "app_id": "your-app-id",
      "name": "added_to_cart",
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "transaction_id": "13791e08-7c22-4f6c-8cc6-832c76af3743",
        "purchase": {
          "product_skus": ["ADI-BL-7", "ADI-WH-9"]
        }
      }
    }
  ]
}
```

{% endtab %}
{% tab 購入オブジェクト %}

購入が行われると、API を通じて購入オブジェクトが渡されます。

マッピングに関しては、カスタムイベントと同様に購入オブジェクトにも同様のロジックが適用されますが、購入オブジェクトの `product_id` を使用するか、`properties` オブジェクトのフィールドを使用するかを選択できます。

ここで、すべてのカタログアイテムにイベントは必要ありませんが、レコメンデーションエンジンの処理に十分なコンテンツを提供するために、いくつかのイベントが必要であることを忘れないでください。

##### 商品 ID にマッピングされた購入オブジェクトの例

このイベントには `"product_id": "ADI-BL-7` があり、カタログの最初のアイテムにマッピングされます。

```json
{
  "purchases": [
    {
      "external_id": "user1",
      "app_id": "11ae5b4b-2445-4440-a04f-bf537764c9ad",
      "product_id": "ADI-BL-7",
      "currency": "USD",
      "price": 100.00,
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "color": "black",
        "checkout_duration": 180,
        "size": "7",
        "brand": "Adidas"
      }
    }
  ]
}
```

##### プロパティフィールドにマッピングされた購入オブジェクトの例

このイベントのプロパティは `"sku": "ADI-RD-8"` で、カタログの 2 番目のアイテムにマッピングされます。

```json
{
  "purchases": [
    {
      "external_id": "user1",
      "app_id": "11ae5b4b-2445-4440-a04f-bf537764c9ad",
      "product_id": "shoes",
      "currency": "USD",
      "price": 100.00,
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "sku": "ADI-RD-8",
        "color": "red",
        "checkout_duration": 180,
        "size": "8",
        "brand": "Adidas"
      }
    }
  ]
}
```

{% endtab %}
{% endtabs %}

### ステップ 5: おすすめをトレーニングする

準備ができたら、[**レコメンデーションを作成**] を選択します。このプロセスは、完了するまで 10 分から 36 時間かかることがあります。おすすめが正常にトレーニングされるか、作成に失敗した場合にはその理由を説明するメール更新が送信されます。

おすすめは [**予測**] ページに表示され、必要に応じて編集したりアーカイブしたりできます。おすすめは、毎月 1 回自動的に再試行されます。

## 分析

おすすめの分析を見ることで、ユーザーがどのアイテムをすすめられたのか、レコメンデーションモデルがどの程度正確だったのかを確認することができます。

1. [**分析**] > [**アイテムのおすすめ**] に移動します。
2. リストからおすすめを選択します。

ページの上部で、精度やカバレッジなどのおすすめに関する統計を確認できます。

![][5]

次の表にこれらの指標の定義を示します。 

| 指標              | 説明 |
| ------------------- | ---------- |
| 精度           | ユーザーが購入した次のアイテムをモデルが正しく予測した回数の割合。精度は、特定のカタログサイズとミックスに大きく依存します。モデルが正しかった頻度を理解するためのガイドとして使用してください。<br><br>過去のテストでは、モデルが 6 ～ 20% の精度で良好なパフォーマンスを提供することがわかっています。この指標は、モデルが次に再トレーニングされるときに更新されます。  |
| カバレッジ            | カタログ内の使用可能なアイテムのうち、少なくとも 1 人のユーザーに推薦されるものの割合。アイテムのカバレッジは、最も人気のあるものよりも、パーソナライズされたアイテムのおすすめの方が高くなることが期待できます。 |
| おすすめのタイプ | フォールバックの人気アイテムを受け取るユーザーに対する、パーソナライズされたおすすめや最新のおすすめを受け取るユーザーの割合。フォールバックは、パーソナライズされた、または最新のおすすめを生成するのに十分なデータがないユーザーに送信されます。 |
{: .reset-td-br-1 .reset-td-br-2 role="presentation" }

次のセクションでは、カタログに掲載されているアイテムの内訳を、次の 2 列に分けて示しています。

- **パーソナライズされたアイテム**または**最新のアイテム:** この列には、カタログ内の各アイテムが、ユーザーへの推奨頻度の降順で表示されます。この列には、モデルによって各アイテムに割り当てられたユーザーの数も表示されます。
- **最も人気のあるアイテム:**この列には、カタログ内の各アイテムが人気の高い順に表示されます。ここでいう「人気」とは、ワークスペース全体でユーザーが最も多くインタラクションを行っているカタログアイテムを指します。個々のユーザーに対してパーソナライズされたおすすめや最新のおすすめを計算できない場合に、フォールバックとして使用されます。

![][6]

**レコメンデーションの概要**には、おすすめが最後に更新された日時など、選択したおすすめ設定の概要が表示されます。

![][7]{: style="max-width:45%" }

## メッセージングにおすすめを使う

![][10]{: style="max-width:30%;float:right;margin-left:15px;"}

おすすめのトレーニングが終了したら、Liquid でメッセージをパーソナライズして、そのカタログで最も人気のある商品を挿入することができます。Liquid は、メッセージ作成画面にあるパーソナライゼーションウィンドウで生成できます。

1. パーソナライゼーションをサポートするメッセージ作成画面では、[<i class="fa-solid fa-circle-plus" style="color: #12aec5;" title="パーソナライゼーションを追加"></i>] を選択してパーソナライゼーションウィンドウを開きます。
2. [**パーソナライゼーションタイプ**] で、[**項目のレコメンデーション**] を選択します。
3. [**項目のレコメンデーション名**] で、先に作成したおすすめを選択します。
4. [**予測アイテム数**] で、挿入する上位商品の数を入力します。たとえば、購入数の多い上位 3 つのアイテムを表示できます。
5. [**表示する情報**] で、カタログのどのフィールドを各アイテムに含めるかを選択します。各アイテムのこれらのフィールドの値は、このおすすめに関連付けられたカタログから取得されます。
6. [**コピー**] アイコンを選択し、メッセージ内の必要な場所に Liquid を貼り付けます。

## AI によるアイテムのおすすめの階層

次の表に、AI によるパーソナライズ、人気、トレンドの各おすすめタイプの無料版と Pro バージョンの違いを示します。

| エリア                   | 無償バージョン                          | Pro バージョン            |
| :---------------------- | ------------------------------------- | :--------------------------------------- |
| ユーザーの更新頻度<sup>1</sup>   | 毎週                                | 毎日                                    |
| モデルの再トレーニング頻度  | 毎月                               | 毎月                                   |
| 最大推奨モデル | タイプごとに1つのモデル<sup>2</sup> | タイプごとに100のモデル<sup>2</sup> |

<sup>1. これは、ユーザー固有のアイテムのおすすめが更新される頻度です (モデルの再トレーニング時に更新される「最も人気のある」アイテムを除くすべてのモデル)。たとえば、ユーザーが AI によるおすすめアイテムに基づいてアイテムを購入した場合、そのおすすめアイテムはこの頻度に従って更新されます</sup><br>
<sup>2. 利用可能なおすすめタイプは、AI パーソナライズ、最新、最高人気、およびトレンドです。</sup>

## よくある質問

### "最も人気のある" アイテムが他のモデルのおすすめアイテムに混在してしまう原因は何ですか?

レコメンデーションエンジンがリストをキュレーションすると、まずは「最も人気」や「AI でパーソナライズ」のように、選択された特定のモデルに基づいてパーソナライズされたセレクションが優先されます。このモデルが、何らかの理由で 30 のおすすめアイテムの完全なリストを満たすことができない場合、すべてのユーザーの中で最も人気のあるアイテムの一部が追加され、各ユーザーに常におすすめアイテムの完全なセットがあることを保証します。

これは、いくつかの特定の条件下で発生します。

- モデルが検出した条件に一致する項目が 30 個に満たない。
- 関連するアイテムが購入不可能で在庫切れとなっている。
- 在庫状況やユーザーの好みの変化により、アイテムが現在の選択基準を満たしていない。

[1]: {% image_buster /assets/img/item_recs_1.png %}
[2-1]: {% image_buster /assets/img/item_recs_2-1.png %}
[2-2]: {% image_buster /assets/img/item_recs_2-2.png %}
[2-3]: {% image_buster /assets/img/item_recs_2-3.png %}
[3]: {% image_buster /assets/img/item_recs_3.png %}
[4]: {% image_buster /assets/img/item_recs_4.png %}
[5]: {% image_buster /assets/img/item_recs_analytics_1.png %}
[6]: {% image_buster /assets/img/item_recs_analytics_2.png %}
[7]: {% image_buster /assets/img/item_recs_analytics_3.png %}
[10]: {% image_buster /assets/img/add_personalization.png %}
[catalog]: {{site.baseurl}}/user_guide/personalization_and_dynamic_content/catalogs/
