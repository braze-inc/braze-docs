---
nav_title: AI レコメンデーション
article_title: AI 項目のレコメンデーションの作成
description: "この記事では、カタログに掲載されているアイテムについて、AI によるアイテムのおすすめを作成する方法を説明します。"
page_order: 1
---

# AI 項目のレコメンデーションの作成

> カタログ内のアイテムからAI レコメンドエンジンを作成する方法について説明します。

## AI 項目の推奨事項について

AI 項目の推奨事項を使用して、最も人気のある製品を計算したり、特定の[カタログ]({{site.baseurl}}/user_guide/personalization_and_dynamic_content/catalogs/) に対してカスタマイズされたAI 推奨事項を作成したりします。おすすめを作成した後、パーソナライゼーションを使用してメッセージにそれらの商品を挿入できます。

{% alert tip %}
[AI でパーソナライズされたおすすめ](#recommendation-types)は、数百から数千のアイテムがあり、通常は購入またはインタラクションデータを持つユーザーが 30,000 人以上いる場合に最も効果的です。これはあくまでも目安であり、様々です。他の推奨タイプは、より少ないデータで動作できます。
{% endalert %}

## AI によるアイテムのおすすめの作成

### 前提条件

始める前に、以下の作業を完了しておく必要があります。

- 以下に説明する推奨タイプを使用するには、少なくとも1 つの[catalog]({{site.baseurl}}/user_guide/personalization_and_dynamic_content/catalogs/) が必要です。
- Braze 上に、カタログに保存されている一意の商品 ID への参照を含む購入データまたはイベントデータ (カスタムイベントまたは購入オブジェクト) があること。

### ステップ1:新しいレコメンデーションを作成する

ダッシュボードのいずれかの場所からAI アイテムの推奨を作成できます。

{% tabs local %}
{% tab ナビゲーションメニューから %}
1. [**分析**] > [**AI によるアイテムのおすすめ**] に移動します。
2. [**予測を作成**] > [**AI によるアイテムのおすすめ**] を選択します。
{% endtab %}

{% tab カタログから %}
個々のカタログから直接おすすめを作成することもできます。[**カタログ**] ページからカタログを選択し、[**レコメンデーションを作成**] を選択します。
{% endtab %}
{% endtabs %}

### ステップ2:おすすめの詳細を追加する

おすすめに名前と説明 (オプション) を付けます。

![名前フィールドと説明フィールドを含む「レコメンデーションの詳細」ステップ。]({% image_buster /assets/img/item_recs_1.png %})

### ステップ 3:おすすめを定義する {#recommendation-type}

推奨タイプを選択します。各タイプは、過去6か月間のインタラクションデータ (購入またはカスタムイベントデータなど) を使用します。それぞれの詳細な情報と使用例については、[Types and Uses Cases]({{site.baseurl}}/user_guide/brazeai/recommendations/)を参照してください。

{% alert tip %}
[**最新**] または [**AI によるパーソナライズ**] を使用する場合、パーソナライズされたおすすめを作成するためのデータが不十分なユーザーには、フォールバックとして 「**最も人気がある**」アイテムが表示されます。[**最も人気がある**] フォールバックを受信したユーザーの割合は、[**分析**] ページに表示されます。
{% endalert %}

#### ステップ 3.1:事前の購入やインタラクションを除外する (オプション)

ユーザーが既に購入したアイテムや、ユーザーが既に使用したアイテムを推薦しないようにするには、[**ユーザーが以前に操作したアイテムをおすすめとして表示しない**] を選択します。このオプションは、おすすめの [**タイプ**] が [**AI によるパーソナライズ**] に設定されている場合にのみ使用できます。

![タイプが「AI によるパーソナライズ」で、「ユーザーが以前に操作したアイテムをおすすめとして表示しない」オプションが選択されている「おすすめを定義する」ステップ。]({% image_buster /assets/img/item_recs_2-3.png %})

この設定により、おすすめが最近更新された場合、ユーザーがすでに購入したアイテムやインタラクションしたアイテムがメッセージングに再利用されるのを防ぐことができます。ただし、おすすめ更新の間に購入したアイテムや、対話したアイテムが表示されることはあります。無料版のアイテムおすすめでは、更新は毎週行われます。プロバージョンの AI によるアイテムおすすめでは、更新が 24 時間ごとに行われます。

たとえば、AI によるアイテムのおすすめの Pro バージョンを使用している場合、ユーザーが何かを購入し、その後 30 分以内にマーケターメールを受信した場合、購入したばかりのアイテムが時間内にメールから除外されない可能性があります。ただし、24 時間後に送信されるメッセージには、そのアイテムは含まれません。

#### ステップ 3.2:カタログを選択する

まだ入力されていない場合は、レコメンデーションを取得する[カタログ]({{site.baseurl}}/user_guide/personalization_and_dynamic_content/catalogs/)を選択します。

#### ステップ3.3：セレクションを追加する (オプション)

おすすめをさらに制御したい場合は、[[セレクション]({{site.baseurl}}/user_guide/personalization_and_dynamic_content/catalogs/selections/)] を選択してカスタムフィルターを適用します。セレクションは、ブランド、サイズ、場所など、カタログ内の特定の列によって、おすすめアイテムをフィルタリングします。Liquid を含むセレクションは、おすすめで使用できません。

![レコメンデーションでセレクションとして「在庫」が選択されている例。]({% image_buster /assets/img/item_recs_2-2.png %})

{% alert tip %}
セレクションが見つからない場合は、まずカタログで設定されていることを確認してください。
{% endalert %}

### ステップ4:おすすめを推進するインタラクションを選択する

このおすすめを最適化するイベントを選択します。このイベントは通常、「購入」ですが、アイテムとのインタラクションも可能です。

以下のイベントで最適化できます。

- [[購入オブジェクト]({{site.baseurl}}/api/objects_filters/purchase_object/)] のある購入イベント
- 購入を表すカスタムイベント
- 他のアイテムインタラクションを表すカスタムイベント (商品の表示、クリック、メディア再生など)

[**カスタムイベント**] を選択した場合は、リストからイベントを選択します。

![イベントの現在の追跡方法として選択されている「購入完了」カスタムイベント。]({% image_buster /assets/img/item_recs_3.png %})

### ステップ 5: 対応するプロパティ名を選択する {#property-name}

おすすめを作成するには、インタラクションイベント (購入オブジェクトまたはカスタムイベント) のどのフィールドが、カタログのアイテムの `id` フィールドと一致する一意の識別子を持っているかを Braze に伝える必要があります。よくわからない場合は[要件を確認](#requirements)してください。

このフィールドを [**プロパティ名**] に選択します。

[**プロパティ名**] フィールドに、SDK 経由で Braze に送信されるフィールドのリストがあらかじめ入力されます。十分なデータが提供されていれば、これらのプロパティはそれが正しいプロパティである確率の順にランク付けされます。カタログの `id` フィールドに対応するものを選択します。

![カタログ内の項目 ID に対応するプロパティ名「purchase_item」が選択されている。]({% image_buster /assets/img/item_recs_4.png %})

#### 要件 {#requirements}

プロパティを選択するには、いくつかの要件があります。

- 選択したカタログの `id` フィールドにマッピングする必要があります。
- **購入オブジェクトを選択した場合:**`product_id` またはインタラクションイベントの `properties` のフィールドである必要があります。
- **カスタムイベントを選択した場合:**カスタムイベントの `properties` のフィールドである必要があります。
- ネストされたフィールドは、ドット表記を用いて `event_property.nested_property` の形式で [**プロパティ名**] ドロップダウンに入力する必要があります。たとえば、イベントプロパティ `location` 内のネストされたプロパティ `district_name` を選択する場合は、「`location.district_name`」と入力します。
- フィールドは商品の配列の中にあってもいいし、IDの配列で終わってもいい。いずれの場合も、各製品 ID は、同じタイムスタンプを持つ個別の連続したイベントとして扱われます。

#### マッピングの例

以下のマッピング例は、どちらもこのサンプルカタログを参照しています。

<style type="text/css">
.tg td{word-break:normal;}
.tg th{word-break:normal;font-size: 14px; font-weight: bold; background-color: #f4f4f7; text-transform: lowercase; color: #212123; font-family: "Sailec W00 Bold",Arial,Helvetica,sans-serif;}
.tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top;word-break:normal}
</style>
<table class="tg">
<thead>
  <tr>
    <th class="tg-0pky">id</th>
    <th class="tg-0pky">名称</th>
    <th class="tg-0pky">価格</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0pky">ADI-BL-7</td>
    <td class="tg-0pky">アディダスブラックサイズ 7</td>
    <td class="tg-0pky">100.00 米ドル</td>
  </tr>
  <tr>
    <td class="tg-0pky">ADI-RD-8</td>
    <td class="tg-0pky">アディダスレッドサイズ 8</td>
    <td class="tg-0pky">100.00 米ドル</td>
  </tr>
  <tr>
    <td class="tg-0pky">ADI-WH-9</td>
    <td class="tg-0pky">アディダスホワイトサイズ 9</td>
    <td class="tg-0pky">100.00 米ドル</td>
  </tr>
  <tr>
    <td class="tg-0pky">ADI-PP-10</td>
    <td class="tg-0pky">アディダスパープルサイズ 10</td>
    <td class="tg-0pky">75.00 米ドル</td>
  </tr>
</tbody>
</table>

{% tabs %}
{% tab カスタムイベント %}

たとえば、カスタムイベント `added_to_cart` を使用して、顧客がチェックアウトする前に同様の商品をお勧めできるようにするとします。イベント `added_to_cart` にはイベントプロパティ `product_sku` があります。

`product_sku` プロパティには、サンプルカタログの `id` 列の値のうち少なくとも 1 つが含まれている必要があります: "ADI-BL-7"、"ADI-RD-8"、"ADI-WH-9"、または "ADI-PP-10"。すべてのカタログアイテムにイベントは必要ありませんが、レコメンデーションエンジンの処理に十分なコンテンツを提供するために、いくつかのイベントが必要です。

##### カスタムイベントオブジェクトの例

このイベントには `"product_sku": "ADI-BL-7"` があり、サンプルカタログの最初のアイテムと一致します。

```json
{
  "events": [
    {
      "external_id": "user1",
      "app_id": "your-app-id",
      "name": "added_to_cart",
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "product_sku": "ADI-BL-7"
      }
    }
  ]
}
```

##### 商品の配列を持つカスタムイベントオブジェクトの例

イベント・プロパティが複数の製品を配列に含む場合、各製品IDは個別の連続したイベントとして扱われる。このイベントは、プロパティ `products.sku` を使用して、サンプルカタログの1番目のアイテムと3番目のアイテムに一致させることができます。

```json
{
  "events": [
    {
      "external_id": "user1",
      "app_id": "your-app-id",
      "name": "added_to_cart",
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "transaction_id": "2ff3f9a9-8803-4c3a-91da-14adbf93dc99",
        "products": [
          { "sku": "ADI-BL-7" },
          { "sku": "ADI-WH-9" }
        ]
      }
    }
  ]
}
```

##### 商品ID配列を含むネストされたオブジェクトを持つカスタムイベントオブジェクトの例

商品IDがオブジェクトではなく配列の値である場合も、同じ記法を使うことができ、各商品IDは個別の連続したイベントとして扱われる。これは、次のイベントでネストされたオブジェクトと柔軟に組み合わせることができます。このためには、サンプルカタログの1番目と3番目のアイテムに一致するようにこのプロパティを `purchase.product_skus` として設定します。

```json
{
  "events": [
    {
      "external_id": "user1",
      "app_id": "your-app-id",
      "name": "added_to_cart",
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "transaction_id": "13791e08-7c22-4f6c-8cc6-832c76af3743",
        "purchase": {
          "product_skus": ["ADI-BL-7", "ADI-WH-9"]
        }
      }
    }
  ]
}
```

{% endtab %}
{% tab 購入オブジェクト %}

購入が行われると、API を通じて購入オブジェクトが渡されます。

マッピングに関しては、カスタムイベントと同様に購入オブジェクトにも同様のロジックが適用されますが、購入オブジェクトの `product_id` を使用するか、`properties` オブジェクトのフィールドを使用するかを選択できます。

ここで、すべてのカタログアイテムにイベントは必要ありませんが、レコメンデーションエンジンの処理に十分なコンテンツを提供するために、いくつかのイベントが必要であることを忘れないでください。

##### 商品 ID にマッピングされた購入オブジェクトの例

このイベントには `"product_id": "ADI-BL-7` があり、カタログの最初のアイテムにマッピングされます。

```json
{
  "purchases": [
    {
      "external_id": "user1",
      "app_id": "11ae5b4b-2445-4440-a04f-bf537764c9ad",
      "product_id": "ADI-BL-7",
      "currency": "USD",
      "price": 100.00,
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "color": "black",
        "checkout_duration": 180,
        "size": "7",
        "brand": "Adidas"
      }
    }
  ]
}
```

##### プロパティフィールドにマッピングされた購入オブジェクトの例

このイベントのプロパティは `"sku": "ADI-RD-8"` で、カタログの 2 番目のアイテムにマッピングされます。

```json
{
  "purchases": [
    {
      "external_id": "user1",
      "app_id": "11ae5b4b-2445-4440-a04f-bf537764c9ad",
      "product_id": "shoes",
      "currency": "USD",
      "price": 100.00,
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "sku": "ADI-RD-8",
        "color": "red",
        "checkout_duration": 180,
        "size": "8",
        "brand": "Adidas"
      }
    }
  ]
}
```

{% endtab %}
{% endtabs %}

### ステップ 6: おすすめをトレーニングする

準備ができたら、[**レコメンデーションを作成**] を選択します。このプロセスは、完了するまで 10 分から 36 時間かかることがあります。おすすめが正常にトレーニングされるか、作成に失敗した場合にはその理由を説明するメール更新が送信されます。

おすすめは [**予測**] ページに表示され、必要に応じて編集したりアーカイブしたりできます。レコメンデーションは、毎週1回 (有料) または毎月1回 (無料) 自動的に再試行されます。

## プラン別の機能

次の表に、AI によるパーソナライズ、人気、トレンドの各おすすめタイプの無料版と Pro バージョンの違いを示します。

| エリア                   | 無償バージョン                          | Pro バージョン            |
| :---------------------- | ------------------------------------- | :--------------------------------------- |
| ユーザーの更新頻度<sup>1</sup>   | 毎週                                | 毎日                                    |
| モデルの再トレーニング頻度  | 毎月                               | 毎週                                   |
| 最大推奨モデル | タイプごとに1つのモデル<sup>2</sup> | タイプごとに100のモデル<sup>2</sup> |

<sup>1. これは、ユーザー固有のアイテムのおすすめが更新される頻度です (モデルの再トレーニング時に更新される「最も人気のある」アイテムを除くすべてのモデル)。たとえば、ユーザーが AI によるおすすめアイテムに基づいてアイテムを購入した場合、そのおすすめアイテムはこの頻度に従って更新されます</sup><br>
<sup>2. 利用可能なおすすめタイプは、AI パーソナライズ、最新、最高人気、およびトレンドです。</sup>

## よくある質問(FAQ) {#faq}

### "最も人気のある" アイテムが他のモデルのおすすめアイテムに混在してしまう原因は何ですか?

レコメンデーションエンジンがリストをキュレーションすると、まずは「最も人気」や「AI でパーソナライズ」のように、選択された特定のモデルに基づいてパーソナライズされたセレクションが優先されます。このモデルが、何らかの理由で 30 のおすすめアイテムの完全なリストを満たすことができない場合、すべてのユーザーの中で最も人気のあるアイテムの一部が追加され、各ユーザーに常におすすめアイテムの完全なセットがあることを保証します。

これは、いくつかの特定の条件下で発生します。

- モデルが検出した条件に一致する項目が 30 個に満たない。
- 関連するアイテムが購入不可能で在庫切れとなっている。
- 在庫状況やユーザーの好みの変化により、アイテムが現在の選択基準を満たしていない。

### アイテムレコメンドプロにアップグレードした後、既存のレコメンドは週1回トレーニングされますか?

はい。ただしスケジュールされている次回の更新後のみです。Item Recommendations Pro にアップグレードした直後は、既存のレコメンデーションは週次トレーニングおよび日次予測に切り替えられません。ただし、次回の再トレーニングサイクルで自動的に新しいスケジュールが適用されます。たとえば、レコメンデーションの最終トレーニングが2月1日であり、30日ごとに再トレーニングするように設定されている場合、3月2日の次回の更新後に新しい週単位のスケジュールが適用されます。
