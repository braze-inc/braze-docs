---
nav_title: AIの推奨事項
article_title: AI 項目のレコメンデーションの作成
description: "この記事では、カタログに掲載されているアイテムについて、AI によるアイテムのおすすめを作成する方法を説明します。"
page_order: 1
---

# AI 項目のレコメンデーションの作成

> カタログ内のアイテムからAI レコメンドエンジンを作成する方法について説明します。

## AI 項目の推奨事項について

AI 項目の推奨事項を使用して、最も人気のある製品を計算したり、特定の[カタログ]({{site.baseurl}}/user_guide/data/activation/catalogs/) に対してカスタマイズされたAI 推奨事項を作成したりします。おすすめを作成した後、パーソナライゼーションを使用してメッセージにそれらの商品を挿入できます。

{% alert tip %}
[AI でパーソナライズされたおすすめ](#recommendation-types)は、数百から数千のアイテムがあり、通常は購入またはインタラクションデータを持つユーザーが 30,000 人以上いる場合に最も効果的です。これはあくまでも目安であり、様々です。他の推奨タイプは、より少ないデータで動作できます。
{% endalert %}

{% multi_lang_include brazeai/recommendations/ai.md section="Plan-specific features" %}

## AI によるアイテムのおすすめの作成

### 前提条件

始める前に、以下の作業を完了しておく必要があります。

- 以下に説明する推奨タイプを使用するには、少なくとも1 つの[catalog]({{site.baseurl}}/user_guide/data/activation/catalogs/) が必要です。
- Braze 上に、カタログに保存されている一意の商品 ID への参照を含む購入データまたはイベントデータ (カスタムイベントまたは購入オブジェクト) があること。

### ステップ1:新しいレコメンデーションを作成する

ダッシュボードのいずれかの場所からAI アイテムの推奨を作成できます。

{% tabs local %}
{% tab From the navigation menu %}
1. [**分析**] > [**AI によるアイテムのおすすめ**] に移動します。
2. [**予測を作成**] > [**AI によるアイテムのおすすめ**] を選択します。
{% endtab %}

{% tab From a catalog %}
個々のカタログから直接おすすめを作成することもできます。[**カタログ**] ページからカタログを選択し、[**レコメンデーションを作成**] を選択します。
{% endtab %}
{% endtabs %}

### ステップ2:おすすめの詳細を追加する

おすすめに名前と説明 (オプション) を付けます。

\!["推薦の詳細 "ステップに名前と説明のフィールドを追加する。]({% image_buster /assets/img/item_recs_1.png %})

### ステップ 3: おすすめを定義する {#recommendation-type}

推奨タイプを選択します。各タイプは、過去6か月間のインタラクションデータ (購入またはカスタムイベントデータなど) を使用します。それぞれの詳細な情報と使用例については、[Types and Uses Cases]({{site.baseurl}}/user_guide/brazeai/recommendations/)を参照してください。

{% alert tip %}
[**最新**] または [**AI によるパーソナライズ**] を使用する場合、パーソナライズされたおすすめを作成するためのデータが不十分なユーザーには、フォールバックとして 「**最も人気がある**」アイテムが表示されます。[**最も人気がある**] フォールバックを受信したユーザーの割合は、[**分析**] ページに表示されます。
{% endalert %}

#### ステップ 3.1:事前の購入やインタラクションを除外する (オプション)

ユーザーが既に購入したアイテムや、ユーザーが既に使用したアイテムを推薦しないようにするには、[**ユーザーが以前に操作したアイテムをおすすめとして表示しない**] を選択します。このオプションは、おすすめの [**タイプ**] が [**AI によるパーソナライズ**] に設定されている場合にのみ使用できます。

\![AIパーソナライズされた "をタイプとして選択し、"ユーザーが過去に使用したことのあるアイテムは勧めない "オプションを選択する。]({% image_buster /assets/img/item_recs_2-3.png %})

この設定により、おすすめが最近更新された場合、ユーザーがすでに購入したアイテムやインタラクションしたアイテムがメッセージングに再利用されるのを防ぐことができます。ただし、おすすめ更新の間に購入したアイテムや、対話したアイテムが表示されることはあります。無料版のアイテムおすすめでは、更新は毎週行われます。プロバージョンの AI によるアイテムおすすめでは、更新が 24 時間ごとに行われます。

たとえば、AI によるアイテムのおすすめの Pro バージョンを使用している場合、ユーザーが何かを購入し、その後 30 分以内にマーケターメールを受信した場合、購入したばかりのアイテムが時間内にメールから除外されない可能性があります。ただし、24 時間後に送信されるメッセージには、そのアイテムは含まれません。

#### ステップ 3.2:カタログを選択する

まだ入力されていない場合は、レコメンデーションを取得する[カタログ]({{site.baseurl}}/user_guide/data/activation/catalogs/)を選択します。

#### ステップ3.3：セレクションを追加する (オプション)

おすすめをさらに制御したい場合は、[[セレクション]({{site.baseurl}}/user_guide/data/activation/catalogs/selections/)] を選択してカスタムフィルターを適用します。セレクションは、ブランド、サイズ、場所など、カタログ内の特定の列によって、おすすめアイテムをフィルタリングします。Liquid を含むセレクションは、おすすめで使用できません。

\![推薦に選ばれた「在庫あり」のセレクションの例。]({% image_buster /assets/img/item_recs_2-2.png %})

{% alert tip %}
セレクションが見つからない場合は、まずカタログで設定されていることを確認してください。
{% endalert %}

### ステップ4:おすすめを推進するインタラクションを選択する

このおすすめを最適化するイベントを選択します。このイベントは通常、「購入」ですが、アイテムとのインタラクションも可能です。

以下のイベントで最適化できます。

- [[購入オブジェクト]({{site.baseurl}}/api/objects_filters/purchase_object/)] のある購入イベント
- 購入を表すカスタムイベント
- 他のアイテムインタラクションを表すカスタムイベント (商品の表示、クリック、メディア再生など)

[**カスタムイベント**] を選択した場合は、リストからイベントを選択します。

\![現在どのようにイベントがトラッキング, 追跡されるかとして選択された "Completed Purchase "カスタムイベント。]({% image_buster /assets/img/item_recs_3.png %})

### ステップ 5: 対応するプロパティ名を選択する {#property-name}

おすすめを作成するには、インタラクションイベント (購入オブジェクトまたはカスタムイベント) のどのフィールドが、カタログのアイテムの `id` フィールドと一致する一意の識別子を持っているかを Braze に伝える必要があります。よくわからない場合は[要件を確認](#requirements)してください。

このフィールドを [**プロパティ名**] に選択します。

[**プロパティ名**] フィールドに、SDK 経由で Braze に送信されるフィールドのリストがあらかじめ入力されます。十分なデータが提供されていれば、これらのプロパティはそれが正しいプロパティである確率の順にランク付けされます。カタログの `id` フィールドに対応するものを選択します。

\![カタログのアイテム ID に対応するプロパティ名"purchase_item" が選択されている。]({% image_buster /assets/img/item_recs_4.png %})

#### 要件 {#requirements}

プロパティを選択するには、いくつかの要件があります。

- 選択したカタログの `id` フィールドにマッピングする必要があります。
- **購入オブジェクトを選択した場合:**`product_id` またはインタラクションイベントの `properties` のフィールドである必要があります。
- **カスタムイベントを選択した場合:**カスタムイベントの `properties` のフィールドである必要があります。
- ネストされたフィールドは、ドット表記を用いて `event_property.nested_property` の形式で [**プロパティ名**] ドロップダウンに入力する必要があります。たとえば、イベントプロパティ `location` 内のネストされたプロパティ `district_name` を選択する場合は、「`location.district_name`」と入力します。
- フィールドは商品の配列の中にあってもいいし、IDの配列で終わってもいい。いずれの場合も、各製品 ID は、同じタイムスタンプを持つ個別の連続したイベントとして扱われます。

#### マッピングの例

以下のマッピング例は、どちらもこのサンプルカタログを参照しています。

<style type="text/css">
.tg td{word-break:normal;}
.tg th{word-break:normal;font-size: 14px; font-weight: bold; background-color: #f4f4f7; text-transform: lowercase; color: #212123; font-family: "Sailec W00 Bold",Arial,Helvetica,sans-serif;}
.tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top;word-break:normal}
</style>
<table class="tg">
<thead>
  <tr>
    <th class="tg-0pky">id</th>
    <th class="tg-0pky">名称</th>
    <th class="tg-0pky">価格</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0pky">ADI-BL-7</td>
    <td class="tg-0pky">アディダスブラックサイズ 7</td>
    <td class="tg-0pky">100.00 米ドル</td>
  </tr>
  <tr>
    <td class="tg-0pky">ADI-RD-8</td>
    <td class="tg-0pky">アディダスレッドサイズ 8</td>
    <td class="tg-0pky">100.00 米ドル</td>
  </tr>
  <tr>
    <td class="tg-0pky">ADI-WH-9</td>
    <td class="tg-0pky">アディダスホワイトサイズ 9</td>
    <td class="tg-0pky">100.00 米ドル</td>
  </tr>
  <tr>
    <td class="tg-0pky">ADI-PP-10</td>
    <td class="tg-0pky">アディダスパープルサイズ 10</td>
    <td class="tg-0pky">75.00 米ドル</td>
  </tr>
</tbody>
</table>

{% tabs %}
{% tab Custom event %}

たとえば、カスタムイベント `added_to_cart` を使用して、顧客がチェックアウトする前に同様の商品をお勧めできるようにするとします。イベント `added_to_cart` にはイベントプロパティ `product_sku` があります。

`product_sku` プロパティには、サンプルカタログの `id` 列の値のうち少なくとも 1 つが含まれている必要があります: "ADI-BL-7"、"ADI-RD-8"、"ADI-WH-9"、または "ADI-PP-10"。すべてのカタログアイテムにイベントは必要ありませんが、レコメンデーションエンジンの処理に十分なコンテンツを提供するために、いくつかのイベントが必要です。

##### カスタムイベントオブジェクトの例

このイベントには `"product_sku": "ADI-BL-7"` があり、サンプルカタログの最初のアイテムと一致します。

```json
{
  "events": [
    {
      "external_id": "user1",
      "app_id": "your-app-id",
      "name": "added_to_cart",
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "product_sku": "ADI-BL-7"
      }
    }
  ]
}
```

##### 商品の配列を持つカスタムイベントオブジェクトの例

イベント・プロパティが複数の製品を配列に含む場合、各製品IDは個別の連続したイベントとして扱われる。このイベントは、プロパティ `products.sku` を使用して、サンプルカタログの1番目のアイテムと3番目のアイテムに一致させることができます。

```json
{
  "events": [
    {
      "external_id": "user1",
      "app_id": "your-app-id",
      "name": "added_to_cart",
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "transaction_id": "2ff3f9a9-8803-4c3a-91da-14adbf93dc99",
        "products": [
          { "sku": "ADI-BL-7" },
          { "sku": "ADI-WH-9" }
        ]
      }
    }
  ]
}
```

##### 商品ID配列を含むネストされたオブジェクトを持つカスタムイベントオブジェクトの例

商品IDがオブジェクトではなく配列の値である場合も、同じ記法を使うことができ、各商品IDは個別の連続したイベントとして扱われる。これは、次のイベントでネストされたオブジェクトと柔軟に組み合わせることができます。このためには、サンプルカタログの1番目と3番目のアイテムに一致するようにこのプロパティを `purchase.product_skus` として設定します。

```json
{
  "events": [
    {
      "external_id": "user1",
      "app_id": "your-app-id",
      "name": "added_to_cart",
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "transaction_id": "13791e08-7c22-4f6c-8cc6-832c76af3743",
        "purchase": {
          "product_skus": ["ADI-BL-7", "ADI-WH-9"]
        }
      }
    }
  ]
}
```

{% endtab %}
{% tab Purchase object %}

購入が行われると、API を通じて購入オブジェクトが渡されます。

マッピングに関しては、カスタムイベントと同様に購入オブジェクトにも同様のロジックが適用されますが、購入オブジェクトの `product_id` を使用するか、`properties` オブジェクトのフィールドを使用するかを選択できます。

ここで、すべてのカタログアイテムにイベントは必要ありませんが、レコメンデーションエンジンの処理に十分なコンテンツを提供するために、いくつかのイベントが必要であることを忘れないでください。

##### 商品 ID にマッピングされた購入オブジェクトの例

このイベントには `"product_id": "ADI-BL-7` があり、カタログの最初のアイテムにマッピングされます。

```json
{
  "purchases": [
    {
      "external_id": "user1",
      "app_id": "11ae5b4b-2445-4440-a04f-bf537764c9ad",
      "product_id": "ADI-BL-7",
      "currency": "USD",
      "price": 100.00,
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "color": "black",
        "checkout_duration": 180,
        "size": "7",
        "brand": "Adidas"
      }
    }
  ]
}
```

##### プロパティフィールドにマッピングされた購入オブジェクトの例

このイベントのプロパティは `"sku": "ADI-RD-8"` で、カタログの 2 番目のアイテムにマッピングされます。

```json
{
  "purchases": [
    {
      "external_id": "user1",
      "app_id": "11ae5b4b-2445-4440-a04f-bf537764c9ad",
      "product_id": "shoes",
      "currency": "USD",
      "price": 100.00,
      "time": "2024-07-16T19:20:30+01:00",
      "properties": {
        "sku": "ADI-RD-8",
        "color": "red",
        "checkout_duration": 180,
        "size": "8",
        "brand": "Adidas"
      }
    }
  ]
}
```

{% endtab %}
{% endtabs %}

### ステップ 6: おすすめをトレーニングする

準備ができたら、[**レコメンデーションを作成**] を選択します。このプロセスは、完了するまで 10 分から 36 時間かかることがあります。おすすめが正常にトレーニングされるか、作成に失敗した場合にはその理由を説明するメール更新が送信されます。

おすすめは [**予測**] ページに表示され、必要に応じて編集したりアーカイブしたりできます。レコメンデーションは、毎週1回 (有料) または毎月1回 (無料) 自動的に再試行されます。